/* Copyright (C) 2012 NS Solutions Corporation. Licensed under the Apache License, Version 2.0. hifive version 0.0.1 (util,controller,view,ui,api.geo,api.sqldb,api.storage) */
(function(b){function i(b,k,c){var n=Error();b&&(n.code=b);if(b=R[b])k=[b].concat(k),n.message=e.u.str.format.apply(null,k);c&&(n.detail=c);throw n;}function M(b){for(code in b)b.hasOwnProperty(code)&&(R[code]=b[code])}function K(b,k,c){var n=null,i=R[b];i&&(k=[i].concat(k),n=e.u.str.format.apply(null,k));return{code:b,message:n,detail:c}}function B(e){return null==e?e:b.isArray(e)?e:[e]}function N(b){var e=document.createElement("span");e.innerHTML='<a href="'+b+'" />';return e.firstChild.href}function O(e){if("regexp"===
b.type(e))return e;var k="",k=-1!==e.indexOf("*")?b.map(e.split("*"),function(b){return b.replace(/\W/g,"\\$&")}).join(".*"):e;return RegExp("^"+k+"$")}var X=void 0;if(window.h5){if(window.h5.env&&"0.0.1"===window.h5.env.version)return;X=window.h5}var e={};window.h5=e;e.coexist=function(){window.h5=X;return e};e.env={version:"0.0.1"};var R={};(function(){function l(b){switch(b){case "string":return"s";case "number":return"n";case "boolean":return"b";case "String":return"S";case "Number":return"N";
case "Boolean":return"B";case "infinity":return"i";case "-infinity":return"I";case "nan":return"x";case "date":return"d";case "regexp":return"r";case "array":return"a";case "object":return"o";case "null":return"l";case k:return"u";case "undefElem":return"_";case "objElem":return"@"}}var k="undefined",c=11005,n=11006,p={11E3:"{0} 第一引数には空文字で無い文字列を指定して下さい。",11001:'名前空間"{0}"には、プロパティ"{1}"が既に存在します。',11002:"Function型のオブジェクトは変換できません。",11003:"シリアライザのバージョンが違います。シリアライズされたバージョン：{0} 現行のバージョン：{1}",11004:"型情報の判定に失敗したため、デシリアライズできませんでした。"};
p[c]="循環参照が含まれています。";p[n]="不正な値が含まれるため、デシリアライズできませんでした。";p[11007]="スクリプトのパスが不正です。空文字以外の文字列、またはその配列を指定して下さい。";p[11008]="{0} オプションの指定が不正です。プレーンオブジェクトで指定してください。";M(p);var q=[],u={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;","'":"&apos;"},d=function(j){j||i(11E3,"h5.u.obj.ns()");"string"!==b.type(j)&&i(11E3,"h5.u.obj.ns()");for(var j=j.split("."),c=window,o=0,e=j.length;o<e;o++)void 0===c[j[o]]&&(c[j[o]]={}),c=c[j[o]];return c},p=function(b,c){var o=d(b),e;for(e in c)c.hasOwnProperty(e)&&(o[e]&&i(11001,
b,e),o[e]=c[e])};p("h5.u",{loadScript:function(j,c){var o=B(j);(!o||0===o.length)&&i(11007);for(var d=0,f=o.length;d<f;d++)j=o[d],("string"!==typeof j||!b.trim(j))&&i(11007);null!=c&&!b.isPlainObject(c)&&i(11008,"h5.u.loadScript()");var g=c&&!0===c.force,a=o.length;if(!c||!0!==c.async){f=b("head");for(d=0;d<a;d++){var m=N(o[d]);if(g||-1===b.inArray(m,q))f.append('<script type="text/javascript" src="'+m+'"><\/script>'),q.push(m)}}else{var n=c&&!0===c.parallel,r=[],t=e.async.deferred(),k=document.head||
document.getElementsByTagName("head")[0],l=function(j){var f=j;if(a<=f)b.when.apply(b,r).done(function(){t.resolve()});else if(j=N(o[f]),!g&&-1!==b.inArray(j,q))l(++f);else{var c=document.createElement("script");c.type="text/javascript";var m=n?e.async.deferred():null;window.ActiveXObject?c.onreadystatechange=function(){if("complete"==c.readyState||"loaded"==c.readyState)c.onreadystatechange=null,m?m.resolve():l(++f)}:(c.onerror=function(){c.onerror=null;m?m.resolve():l(++f)},c.onload=function(){c.onload=
null;m?m.resolve():l(++f)});c.src=j;k.appendChild(c);q.push(j);m&&(r.push(m.promise()),l(++f))}};setTimeout(function(){l(0)},0);return t.promise()}},createInterceptor:function(b,c){return function(o){var d={},f=b?b.call(this,o,d):o.proceed();o.result=f;if(!c)return f;if(e.async.isPromise(f)){var g=this;f.always(function(){c.call(g,o,d)});return f}c.call(this,o,d);return f}}});p("h5.u.str",{startsWith:function(b,c){return 0===b.lastIndexOf(c,0)},endsWith:function(b,c){var e=b.length-c.length;return 0<=
e&&b.lastIndexOf(c)===e},format:function(b,c){if(null==b)return"";var e=arguments;return b.replace(/\{(\d+)\}/g,function(b,c){var g=e[parseInt(c,10)+1];return typeof g===k?k:g})},escapeHtml:function(c){return"string"!==b.type(c)?c:c.replace(/[&"'<>]/g,function(b){return u[b]})}});p("h5.u.obj",{expose:p,ns:d,serialize:function(j){function e(b){for(var a=0,c=f.length;a<c;a++)if(b===f[a])return!0;return!1}function o(b){for(var a=0,c=f.length;a<c;a++)b===f[a]&&f.splice(a,1)}function d(g){var a=g,m=b.type(g);
"object"===typeof g&&(g instanceof String?m="String":g instanceof Number?m="Number":g instanceof Boolean&&(m="Boolean"));switch(m){case "String":case "string":a=l(m)+a;break;case "Boolean":a=a.valueOf();case "boolean":a=l(m)+(a?1:0);break;case "Number":a=a.valueOf();if(b.isNaN&&b.isNaN(g)||b.isNumeric&&!b.isNumeric(g))a=Infinity===g.valueOf()?l("infinity"):-Infinity===g.valueOf()?l("-infinity"):l("nan");a=l(m)+a;break;case "number":a=b.isNaN&&b.isNaN(g)||b.isNumeric&&!b.isNumeric(g)?Infinity===g?
l("infinity"):-Infinity===g?l("-infinity"):l("nan"):l(m)+a;break;case "regexp":a=l(m)+a.toString();break;case "date":a=l(m)+ +a;break;case "array":e(g)&&i(c);f.push(g);for(var j=[],a=l(m)+"[",m=0,r=g.length;m<r;m++){j[m.toString()]=!0;var t;t=g.hasOwnProperty(m)?"function"===b.type(g[m])?l(k):d(g[m]).replace(/\\/g,"\\\\").replace(/"/g,'\\"'):l("undefElem");a+='"'+t+'"';m!==g.length-1&&(a+=",")}var m="",n;for(n in g)j[n]||"function"!==b.type(g[n])&&(m+='"'+n+'":"'+d(g[n]).replace(/\\/g,"\\\\").replace(/"/g,
'\\"')+'",');m&&(a+=(g.length?",":"")+'"'+l("objElem")+"{"+m.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),a=a.replace(/,$/,""),a+='}"');a+="]";o(g);break;case "object":e(g)&&i("循環参照が含まれています。");f.push(g);a=l(m)+"{";for(n in g)g.hasOwnProperty(n)&&"function"!==b.type(g[n])&&(a+='"'+n+'":"'+d(g[n]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'",');a=a.replace(/,$/,"");a+="}";o(g);break;case "null":case k:a=l(m)}return a}b.isFunction(j)&&i(11002);var f=[];return"1|"+d(j)},deserialize:function(c){function e(c){function f(b){switch(b){case "s":return"string";
case "n":return"number";case "b":return"boolean";case "S":return"String";case "N":return"Number";case "B":return"Boolean";case "i":return"infinity";case "I":return"-infinity";case "x":return"nan";case "d":return"date";case "r":return"regexp";case "a":return"array";case "o":return"object";case "l":return"null";case "u":return k;case "_":return"undefElem";case "@":return"objElem"}}try{if(c.match(/^(.)(.*)/),type=RegExp.$1,d=RegExp.$2?RegExp.$2:"",void 0!==type&&""!==type){var g=d;switch(f(type)){case "String":d=
new String(d);break;case "string":break;case "Boolean":"0"===d||"1"===d?d=new Boolean("1"===d):i(n);break;case "boolean":"0"===d||"1"===d?d="1"===d:i(n);break;case "Number":d="infinity"===f(d)?new Number(Infinity):"-infinity"===f(d)?new Number(-Infinity):"nan"===f(d)?new Number(NaN):new Number(d);break;case "number":d=parseFloat(d);break;case "array":for(var a=b.parseJSON(d),g=0;g<a.length;g++)switch(f(a[g].substring(0,1))){case "undefElem":delete a[g];break;case "objElem":for(var m=e(l("object")+
a[g].substring(1)),j=[],g=0,r=a.length-1;g<r;g++)j[g]=a[g];var a=j,t;for(t in m)a[t]=m[t];break;default:a[g]=e(a[g])}d=a;break;case "object":a=b.parseJSON(d);for(t in a)a[t]=e(a[t]);d=a;break;case "date":d=new Date(parseInt(g,10));break;case "regexp":g.match(/^\/(.*)\/(.*)$/);d=RegExp(RegExp.$1,RegExp.$2);break;case "null":d=null;break;case k:d=void 0;break;case "nan":d=NaN;break;case "infinity":d=Infinity;break;case "-infinity":d=-Infinity;break;default:i(n)}}}catch(p){d=c}return d}if("string"!==
typeof c)return c;c.match(/^(.)\|(.*)/);c=RegExp.$1;"1"!==c&&i(11003,[c,"1"]);var d=RegExp.$2;return e(d)},isJQueryObject:function(c){return!c||!c.jquery?!1:c.jquery===b().jquery},argsToArray:function(b){return Array.prototype.slice.call(b)},getByPath:function(b){"string"!==typeof b&&i(11E3,"h5.u.obj.getByPath()");b=b.split(".");"window"===b[0]&&b.unshift();for(var c=window,d=0,e=b.length;d<e&&!(c=c[b[d]],null==c);d++);return c}})})();(function(){var l,k,c,n,p,q,u;function d(b){return b.match(/^error$/i)?
l:b.match(/^warn$/i)?k:b.match(/^info$/i)?c:b.match(/^debug$/i)?n:b.match(/^trace$/i)?p:b.match(/^all$/i)?q:b.match(/^none$/i)?u:null}function j(a,c){var d={};if(b.isArray(a)){var h=a.slice(0,3).join(" <- ");0<a.slice(3).length&&(h+=" ...");d.recent=h;d.all=c.join("\n")}else d.recent=a,d.all=c;return d}function y(b){var a="";b.name?a=b.name:(/^\s*function\s*([\w\-\$]+)?\s*\(/i.test(b.toString()),a=RegExp.$1);return a}function o(a){for(var a=e.u.obj.argsToArray(a),c=[],d=0,h=a.length;d<h;d++)c.push(b.type(a[d]));
return c.join(", ")}function v(){}function f(a){("string"!==typeof a||0===b.trim(a).length)&&i(w);this.category=b.trim(a)}var g=10002,a=10003,m=10004,w=10005,r=10007,t=10008,H=10010,A={1E4:'ログターゲットのtypeには、オブジェクト、もしくは"console"のみ指定可能です。',10001:"outの各要素について、categoryは必須項目です。。"};A[g]='category"{0}"が複数回指定されています。';A[a]='level"{0}"の指定は不正です。Number、もしくはtrace, info, debug, warn, error, noneを指定してください。';A[r]='ログターゲット"{0}"が複数回指定されています。';A[m]='"{0}"という名前のログターゲットはありません。';A[w]="categoryは必須項目です。1文字以上の文字列を指定してください。";
A[t]="ログターゲット(targets)の指定は1文字以上の文字列、または配列で指定してください。";A[10009]="ログターゲット(target)の指定はプレーンオブジェクトで指定してください。";A[H]="outの各要素についてcategoryは文字列で指定する必要があります。";M(A);l=50;k=40;c=30;n=20;p=10;q=0;u=-1;var D=null;v.prototype={init:function(){},log:function(b){window.console&&("string"!==typeof b.args[0]?this._logObj(b):this._logMsg(b))},_logMsg:function(b){var a=b.args,c=null,c=1===a.length?a[0]:e.u.str.format.apply(e.u.str,a),a=this._getLogPrefix(b)+c;b.logger.enableStackTrace&&(a+="  ["+b.stackTrace.recent+"]");
b.logger.enableStackTrace&&console.groupCollapsed?console.groupCollapsed(a):this._consoleOut(b.level,a);b.logger.enableStackTrace&&this._consoleOut(b.level,b.stackTrace.all);b.logger.enableStackTrace&&console.groupEnd&&console.groupEnd()},_consoleOut:function(b,a){var d=!1;b==l&&console.error?(console.error(a),d=!0):b==k&&console.warn?(console.warn(a),d=!0):b==c&&console.info?(console.info(a),d=!0):b==n&&console.debug&&(console.debug(a),d=!0);!d&&console.log&&console.log(a)},_getLogPrefix:function(b){return"["+
b.levelString+"]"+b.date.getHours()+":"+b.date.getMinutes()+":"+b.date.getSeconds()+","+b.date.getMilliseconds()+": "},_logObj:function(b){var a=b.args,d=this._getLogPrefix(b);a.unshift(d);b.level==l&&console.error?this._output(console.error,a):b.level==k&&console.warn?this._output(console.warn,a):b.level==c&&console.info?this._output(console.info,a):b.level==n&&console.debug?this._output(console.debug,a):this._output(console.log,a)},_output:function(b,a){var c=b;b.call||(c=function(a){b(a)});c.call(console,
a)}};f.prototype={enableStackTrace:!1,maxStackSize:10,error:function(b){this._log(l,arguments,this.error)},warn:function(b){this._log(k,arguments,this.warn)},info:function(b){this._log(c,arguments,this.info)},debug:function(b){this._log(n,arguments,this.debug)},trace:function(b){this._log(p,arguments,this.trace)},_traceFunctionName:function(a){var c=Error(),d=c.stack||c.stacktrace,c={},h=[];if(d)var h=d.replace(/\r\n/,"\n").replace(/at\b|@|Error\b|\t|\[arguments not available\]/ig,"").replace(/(http|https|file):.+[0-9]/g,
"").replace(/ +/g," ").split("\n"),g=null,h=b.map(h,function(a){return g=0===a.length?null:""===b.trim(a)?"{anonymous}":b.trim(a)}),c=j(h.slice(3,h.length),h.slice(0,this.maxStackSize));else if(a=a.caller,d=0,a)for(;;){var f=o(a.arguments),m=y(a);m?h.push("{"+m+"}("+f+")"):a.caller?h.push("{anonymous}("+f+")"):h.push("{root}("+f+")");if(!a.caller||d>=this.maxStackSize){c=j(h,h);break}a=a.caller;d++}else j("{unable to trace}","{unable to trace}");return c},_log:function(b,a,c){var a={level:b,args:e.u.obj.argsToArray(a),
stackTrace:this.enableStackTrace?this._traceFunctionName(c):""},h=D.out,d=D.defaultOut,c=null;if(h)for(var h=B(h),f=0,g=h.length;f<g;f++){var m=h[f];if(m.compiledCategory.test(this.category)){c=m;break}}c||(c=d);f=c.compiledLevel;c=c.compiledTargets;if(!(b<f||0>f))if(a.logger=this,a.date=new Date,a.levelString=this._levelToString(b),c&&0!==c.length){f=0;for(g=c.length;f<g;f++)c[f].log(a)}},_levelToString:function(b){if(b===l)return"ERROR";if(b===k)return"WARN";if(b===c)return"INFO";if(b===n)return"DEBUG";
if(b===p)return"TRACE"}};e.u.obj.expose("h5.log",{createLogger:function(b){return new f(b)},configure:function(){function c(h,e,n){var x=null==n;if(!x){var l=e.category;("string"!==typeof l||0===b.trim(l).length)&&i(H);l=b.trim(l);-1!==b.inArray(l,j)&&i(g,e.category);e.compiledCategory=O(l);j.push(l)}l=null==e.level?d(x?f.level:n.level):"string"===typeof e.level?d(b.trim(e.level)):e.level;"number"!==typeof l&&i(a,e.level);e.compiledLevel=l;var l=[],k=e.targets;if(!x||null!=k){var s=[];null==k||b.isArray(k)||
"string"===typeof k&&b.trim(k).length||i(t);for(var k=B(k),w=0,p=k.length;w<p;w++){null==k[w]||"string"===typeof k[w]&&b.trim(k[w]).length||i(t);var o=k[w];if(o){-1!==b.inArray(o,s)&&i(r,o);var I=h[o];I||i(m,o);s.push(o);l.push(I.compiledTarget)}}if(!x&&(h=n.targets,null!=h)){h=B(h);w=0;for(p=h.length;w<p;w++)o=h[w],-1===b.inArray(o,s)&&(l.push(n.compiledTargets[w]),s.push(o))}}e.compiledTargets=l}var f={level:"NONE",targets:null},j=[];D=b.extend(!0,{},e.settings.log?e.settings.log:{defaultOut:f});
var h=D.target;h||(h={},D.target=h);(function(a){b.isPlainObject(a)||i(10009);for(var c in a){var h=a[c];b.type(h.type)!=="object"&&h.type!=="console"&&i(1E4);var d=null,d=h.type==="console"?new v:b.extend(true,{},h.type);d.init&&d.init(h);h.compiledTarget=d}a.console={type:"console",compiledTarget:new v}})(h);var x=D.defaultOut;x||(x=f,D.defaultOut=x);c(h,x);var n=D.out;if(n)for(var n=B(n),l=0,k=n.length;l<k;l++)c(h,n[l],x)}})})();(function(){function l(c){e.settings.aspects=b.map(B(c),function(b){b.target&&
(b.compiledTarget=O(b.target));b.pointCut&&(b.compiledPointCut=O(b.pointCut));return b})}e.u.obj.ns("h5.settings");e.settings={commonFailHandler:null,aspects:null,log:null};var k=e.u.createInterceptor(function(b,c){c.start=new Date;return b.proceed()},function(b,c){this.log.info('{0} "{1}": {2}ms',this.__name,b.funcName,new Date-c.start)}),c=e.u.createInterceptor(function(b){this.log.info('{0} "{1}"が開始されました。',this.__name,b.funcName);this.log.info(b.args);return b.proceed()},function(b){this.log.info('{0} "{1}"が終了しました。',
this.__name,b.funcName)});e.u.obj.expose("h5.core.interceptor",{lapInterceptor:k,logInterceptor:c,errorInterceptor:function(c){var l=null;try{l=c.proceed()}catch(k){e.settings.commonFailHandler&&b.isFunction(e.settings.commonFailHandler)&&e.settings.commonFailHandler.call(null,k)}return l}});b(window.document).trigger("h5preinit");e.settings.aspects&&l(e.settings.aspects);e.log.configure()})();(function(){e.u.obj.expose("h5.env",{ua:function(e){var k=!!e.match(/iPhone/i),c=!!e.match(/iPad/i),n=k||
c,i=!!e.match(/android/i),q=!!e.match(/Windows Phone/i),u=!!e.match(/MSIE/),d=!!e.match(/Firefox/i),j=!!e.match(/Chrome/i)||!!e.match(/CrMo/),y=!i&&!!e.match(/Safari/i)&&!j,o=!!e.match(/Webkit/i),v=!!e.match(/Opera/i),f=i&&!!e.match(/Safari/i)&&!j,g=!(!k&&!q&&!(f&&e.match(/Mobile/)&&!e.match(/SC-01C/)||i&&j&&e.match(/Mobile/)||e.match(/Fennec/i)||e.match(/Opera Mobi/i))),a=!(!c&&!(f&&!e.match(/Mobile/)||i&&j&&!e.match(/Mobile/)||e.match(/SC-01C/)||e.match(/Fennec/i)||e.match(/Opera Tablet/i))),m=
!g&&!a,w=null,r=null,t=function(a,c){return b.trim(e.substring(e.indexOf(a)+a.length,e.indexOf(c))).split("_")},H=function(a,c){var h=b.trim(e.match(!1===c?RegExp(a+"[^;)]*"):RegExp(a+"[^;)]*","i"))).split(" ");return 1===h.length?"":h[h.length-1]},A=function(a,c){var h=b.trim(e.match(!1===c?RegExp(a+"[^;) ]*"):RegExp(a+"[^;) ]*","i"))).split("/");return 1===h.length?"":h[h.length-1]};if(k)r=t("iPhone OS","like"),w=parseInt(r[0]),r=r.join(".");else if(c)r=t("CPU OS","like"),w=parseInt(r[0]),r=r.join(".");
else if(!i||!d)i?(r=H("Android"),w=parseInt(r.split(".")[0])):q&&((r=H("Windows Phone OS"))||(r=H("Windows Phone")),w=parseInt(r.split(".")[0]));u&&v&&(u=!1);var D=t=null;if(n||i&&f)t=w,D=r;else{var E=null;u?E=H("MSIE",!1):j?(E=A("Chrome",!1))||(E=A("CrMo",!1)):y?E=A("Version"):d?E=A("Firefox"):v&&((E=A("Version"))||(E=A("Opera")),E||(E=H("Opera")));E&&(t=parseInt(E.split(".")[0]),D=E)}return{osVersion:w,osVersionFull:r,browserVersion:t,browserVersionFull:D,isiPhone:k,isiPad:c,isiOS:n,isAndroid:i,
isWindowsPhone:q,isIE:u,isFirefox:d,isChrome:j,isSafari:y,isOpera:v,isAndroidDefaultBrowser:f,isSmartPhone:g,isTablet:a,isDesktop:m,isWebkit:o}}(navigator.userAgent)})})();(function(){M({5E3:"h5.async.each() の第1引数は配列のみを扱います。"});var l=function(){var c=b.Deferred();if(!c.notify&&!c.notifyWith&&!c.progress){var k=!1,i=null,l=null;c.__h5__progressCallbacks=[];c.__h5__progressFilters=[];var u=function(b){var a=this.__h5__progressPipeFilters;if(k){var d=l;if(a&&0<a.length)for(var e=0,f=a.length;e<f;e++)d=
a[e].apply(this,B(d));d!==l&&(d=B(d));b.apply(i,d)}c.__h5__progressCallbacks.push(b);c.__h5__progressFilters.push(a);return this};c.progress=u;var d=c.promise;c.promise=function(b){b=d.call(this,b);b.progress=u;return b};c.notify=function(){k=!0;-1!==arguments.length&&(i=this,l=e.u.obj.argsToArray(arguments));var b=c.__h5__progressCallbacks,a=c.__h5__progressFilters,d=e.u.obj.argsToArray(arguments);if(0<b.length)for(var f=0,g=b.length;f<g;f++){var m=d;if(a[f]&&0<a[f].length)for(var j=0,h=a[f].length;j<
h;j++)m=a[f][j].apply(this,B(m));m!==arguments&&(m=B(m));b[f].apply(this,m)}return this};c.notifyWith=function(b,a){k=!0;i=b;l=a;var c=this.__h5__progressCallbacks,d=this.__h5__progressFilters;if(0<c.length)for(var f=0,e=c.length;f<e;f++){var g=a;if(d[f]&&0<d[f].length)for(var h=0,m=d[f].length;h<m;h++)g=d[f][h].apply(this,B(g));g!==a&&(g=B(g));c[f].apply(b,g)}return this};var j=c.pipe;c.pipe=function(b,a,d){b=j.call(this,b,a);d&&(b.__h5__progressPipeFilters=this.__h5__progressPipeFilters?this.__h5__progressPipeFilters.concat([d]):
[d]);b.pipe=c.pipe;b.progress=c.progress;return b}}var y=!1,o=c.fail,v=function(){0<arguments.length&&(y=!0);return o.apply(this,arguments)};c.fail=v;var f=c.always,g=function(){0<arguments.length&&(y=!0);return f.apply(this,arguments)};c.always=g;var a=function(b,a,c){b&&this.done.apply(this,B(b));a&&this.fail.apply(this,B(a));c&&this.progress.apply(this,B(c));return this};c.then=a;var m=c.reject;c.reject=function(){var b=e.settings.commonFailHandler;!y&&b&&o.call(this,b);return m.apply(this,arguments)};
var w=c.rejectWith;c.rejectWith=function(){var b=e.settings.commonFailHandler;!y&&b&&this.fail(b);return w.apply(this,arguments)};var r=c.promise;c.promise=function(b){b=r.call(this,b);b.always=g;b.then=a;b.fail=v;return b};return c},k=function(b){return!!b&&b.done&&b.fail&&!b.resolve&&!b.reject};e.u.obj.expose("h5.async",{deferred:l,isPromise:k,loop:function(c,e,p){b.isArray(c)||i(5E3);var q=l(),u="number"===b.type(p)?p:20,d=!1,j=0,y=c.length,o,v=null,f=function(){if(j===y)q.resolve(c);else if(d)q.reject(c);
else{var b=e.call(c,j,c[j],v);j++;k(b)?b.done(function(){o()}).fail(function(){d=!0;o()}):o()}},g=function(){setTimeout(function(){var b=j-1;0<j&&q.notify({data:c,index:b,value:c[b]});f()},0)},a=!1;o=function(){a||(0===j%u?g():f())};var m=!1,v={resume:function(){!m&&a&&(a=!1,o())},pause:function(){a=!0},stop:function(){m=!0;q.resolve(c)}};g();return q.promise()}})})();(function(){e.u.obj.expose("h5",{ajax:function(i){var k="string"===typeof arguments[0]?arguments[1]:arguments[0],k=k&&(k.error||k.fail||
k.complete||k.always),c=b.ajax.apply(b,arguments);c.progress||(c.progress=function(){});var n=!1,p=e.settings.commonFailHandler;if(!k&&p){c.fail(function(){n||p.apply(null,arguments)});var q=c.fail;c.fail=function(){n=true;return q.apply(c,arguments)};c.error=c.fail;var u=c.always;c.always=function(){n=true;return u.apply(c,arguments)};c.complete=c.always;c.then=function(b,e,k){b&&c.done.apply(c,B(b));e&&c.fail.apply(c,B(e));k&&c.progress.apply(c,B(k));return c}}return c}})})();(function(){function l(b){return!this.__controllerContext.executeListeners?
void 0:b.proceed()}function k(b,a,h){var d=c(b.__name,a);h&&d.push(l);return n(b[a],a,d)}function c(a,c){var h=[],d=e.settings.aspects;if(!d||0===d.length)return h;for(var d=B(d),f=d.length-1;-1<f;f--){var g=d[f];if(!g.target||g.compiledTarget.test(a)){var m=g.interceptors;if(!g.pointCut||g.compiledPointCut.test(c))if(b.isArray(m))for(g=m.length-1;-1<g;g--)h=h.concat(m[g]);else h.push(m)}}return h}function n(b,a,c){for(var h=function(b,a,z){return function(){var c=this;return z.call(c,{target:c,func:b,
funcName:a,args:arguments,proceed:function(){return b.apply(c,this.args)}})}},d=0,f=c.length;d<f;d++)b=h(b,a,c[d]);return b}function p(b){return!!b.match(/^\{.*\}$/)}function q(b){return!!b.match(/^\[.*\]$/)}function u(a){return b.trim(a.substring(1,a.length-1))}function d(a){return b.trim(a.substring(1,a.length-1))}function j(b){return V(b,"window")||V(b,"document")||V(b,"navigator")?Y(b):b}function y(a){var c=function(a,z){for(var h in a)if(0<=b.inArray(a,z)||U(h,aa)&&c(a[h],z.concat([a])))return!0;
return!1};return c(a,[])}function o(a){var c=function(a,z){for(var h in a)if(0<=b.inArray(a,z)||U(h,ba)&&c(a[h],z.concat([a])))return!0;return!1};return c(a,[])}function v(a,c){var h=a[c];return U(c,aa)&&"rootController"!==c&&"parentController"!==c&&!b.isFunction(h)&&h&&!h.__controllerContext.isRoot}function f(a,c,h){var d=[],f=[],e=function(a){f.push(a);for(var z in a)if(v(a,z)){var g=a[z],m=h?g.__controllerContext[c]:g[c];m&&d.push(m);-1===b.inArray(g,f)&&e(g)}};e(a);return d}function g(b){var c=
function(b){var z=b.__meta,h={};if(z)for(var d in z)!1===z[d].useHandlers&&(h[d]=1);for(d in b)z=b[d],v(b,d)&&(c(z),h[d]||a(z))};c(b)}function a(a){var c=a.__controllerContext.bindMap,f;for(f in c)for(var e in c[f]){var g=a,j=f,k=e,r=g.__controllerContext.bindMap[j][k],i=k,n=q(k);n&&(i=d(k));var l=null;switch(i){case "mousewheel":l=x(g,j,i,r);break;case Z:case oa:case ca:l=s(g,j,k,r);break;default:l=h(g,j,i,r)}if(b.isArray(l)){g=0;for(j=l.length;g<j;g++)m(l[g],n)}else m(l,n)}}function m(a,c){c&&(a.eventName=
"["+a.eventName+"]");var h=a.controller,f=a.selector,g=a.eventName,e=a.handler;h.__controllerContext.unbindMap[f]||(h.__controllerContext.unbindMap[f]={});h.__controllerContext.unbindMap[f][g]=e;var h=a.controller.rootElement,m=a.selector,e=a.eventName,f=a.handler,e=(g=q(e))?d(e):e;if(p(m)){var m=u(m),k=!1;m===pa?(m=h,k=!0):m=j(m);k||g||m===document||m===window?b(m).bind(e,f):b(m).live(e,f)}else g?b(m,h).bind(e,f):b(h).delegate(m,e,f)}function w(b){var a=function(b){var c=b.__meta,z={};if(c)for(var h in c)!1===
c[h].useHandlers&&(z[h]=1);for(h in b)c=b[h],v(b,h)&&(a(c),z[h]||r(c))};a(b)}function r(a){var c=a.rootElement,a=a.__controllerContext.unbindMap,h;for(h in a)for(var f in a[h]){var e=a[h][f],g=q(f),m=g?d(f):f;if(p(h)){var k=u(h),x=!1;k===pa?(k=c,x=!0):k=j(k);var i=k===document||k===window;x||g||i?b(k).unbind(m,e):b(k).die(m,e)}else g?b(h,c).unbind(m,e):b(c).undelegate(h,m,e)}}function t(a,c){a.__controllerContext.executeListeners=c;var h=[],d=function(a){h.push(a);for(var z in a)if(v(a,z)){var f=
a[z];f.__controllerContext.executeListeners=c;-1===b.inArray(f,h)&&d(f)}};d(a)}function H(a){var c=[],h=function(a,z,d){a.rootController=z;a.parentController=d;c.push(a);for(var f in a)v(a,f)&&(d=a[f],-1===b.inArray(d,c)&&h(d,z,a))};h(a,a,null)}function A(a,c){var h=c?"__init":"__ready",d=J();setTimeout(function(){d.resolve()},0);var g=d.promise(),m=function(a){var z=!0,d;for(d in a)v(a,d)&&(z=!1,m(a[d]));var j=function(){var b=null;a[h]&&(b=a[h]({args:a.__controllerContext.args}));var z=c?E(a):G(a);
e.async.isPromise(b)?b.done(function(){z()}):z()};d=c?D(a):f(a,"readyPromise");c&&z&&d.push(g);b.when.apply(b,d).done(function(){j()})};m(a)}function D(b){var a=f(b,"initPromise");a.push(b.preinitPromise);return a}function E(b){return function(){if(b.__controllerContext&&!b.__controllerContext.isDisposing){b.isInit=!0;var a=b.__controllerContext.initDfd;delete b.__controllerContext.templatePromise;delete b.__controllerContext.initDfd;a.resolve();b.__controllerContext&&b.__controllerContext.isRoot&&
Ja(b)}}}function G(a){return function(){if(a.__controllerContext&&!a.__controllerContext.isDisposing){a.isReady=!0;var c=a.__controllerContext.readyDfd;delete a.__controllerContext.readyDfd;c.resolve();a.__controllerContext&&a.__controllerContext.isRoot&&a.rootElement&&a.isInit&&a.isReady&&b(a.rootElement).trigger("h5controllerready",[a])}}}function F(a,c,h){if("string"!==typeof a)return b(a);var d=b.trim(a);p(d)?(a=u(d),h&&(V(a,"window")||V(a,"navigator"))&&i(qa),h=b(j(a))):h=b(c).find(a);return h}
function h(b,a,c,h){return{controller:b,selector:a,eventName:c,handler:function(){h.call(b,$(b,arguments))}}}function x(b,a,c,h){return{controller:b,selector:a,eventName:typeof document.onmousewheel===ra?"DOMMouseScroll":c,handler:function(){var a=$(b,arguments),c=a.event;c.originalEvent&&c.originalEvent.detail&&(c.wheelDelta=40*-c.detail);h.call(b,a)}}}function s(a,c,d,f){var e=typeof document.ontouchstart!==ra;if(d!==Z)return e?h(a,c,d,f):h(a,c,d,function(a){var c=a.event,h=b(c.currentTarget).offset()||
{left:0,top:0};c.offsetX=c.pageX-h.left;c.offsetY=c.pageY-h.top;f.apply(this,arguments)});var g=function(b,a){for(var c in b)b.hasOwnProperty(c)&&!a[c]&&"target"!==c&&"currentTarget"!==c&&"originalEvent"!==c&&"liveFired"!==c&&(a[c]=b[c]);a.h5DelegatingEvent=b},m=e?"touchstart":"mousedown",j=e?"touchmove":"mousemove",k=e?"touchend":"mouseup",x=b(document);return function(){var i=null,r=!1,n=function(c,h,d){return function(f){var m;a:{switch(c){case "touchstart":case "mousedown":m=Z;break a;case "touchmove":case "mousemove":m=
oa;break a;case "touchend":case "mouseup":m=ca;break a}m=void 0}var Q=m===Z;if(!Q||!r){var l=$(a,arguments),T=l.event;e&&I(T,c);var o=new b.Event(m);g(T,o);T=T.target;h&&(T=h);d&&d(o);if(!e||r||Q)b(T).trigger(o,l.evArg),r=!0;if(Q&&r){o.h5DelegatingEvent.preventDefault();var Q=o.target,s=o.clientX,w=o.clientY,t=n(j,Q,function(b){var a=b.clientX,c=b.clientY;b.dx=a-s;b.dy=c-w;s=a;w=c}),na=n(k,Q),P=e?b(Q):x;i=function(){P.unbind(j,t);P.unbind(k,na)};P.bind(j,t);P.bind(k,na)}m===ca&&(i(),r=!1)}}},l=[h(a,
c,d,f)];l.push({controller:a,selector:c,eventName:m,handler:n(m)});return l}()}function I(a,c){var h=a.originalEvent,d="touchend"===c||"touchcancel"===c?h.changedTouches[0]:h.touches[0],f=d.pageX,e=d.pageY;a.pageX=h.pageX=f;a.pageY=h.pageY=e;a.screenX=h.screenX=d.screenX;a.screenY=h.screenY=d.screenY;a.clientX=h.clientX=d.clientX;a.clientY=h.clientY=d.clientY;d=a.target;if(d.ownerSVGElement)d=d.farthestViewportElement;else if(d===window||d===document)d=document.body;if(d=b(d).offset())e-=d.top,a.offsetX=
h.offsetX=f-d.left,a.offsetY=h.offsetY=e}function $(a,c){var h=null,d=null;c&&(h=c[0],d=c[1]);var f=h;if(f&&null==f.offsetX&&null==f.offsetY&&f.pageX&&f.pageY){var e=f.target;if(e.ownerSVGElement)e=e.farthestViewportElement;else if(e===window||e===document)e=document.body;if(e=b(e).offset())f.offsetX=f.pageX-e.left,f.offsetY=f.pageY-e.top}return{controller:a,rootElement:a.rootElement,event:h,evArg:d}}function ha(b){for(var a in b){var c=b[a];v(b,a)&&(c.rootElement=null,c.view.__controller=null,ha(c))}}
function P(b){var a=b.rootElement,c=b.__meta,h;for(h in b){var d=b[h];v(b,h)&&(d.rootElement=c&&c[h]&&c[h].rootElement?ia(c[h].rootElement,a,d):a,d.view.__controller=d,P(d))}}function ia(a,c,h){a?(!h||!h.__controllerContext)&&i(sa):i(ta);a=c?F(a,c):b(a);0===a.length&&i(da,[h.__name]);1<a.length&&i(ea,[h.__name]);return a.get(0)}function Ja(c){a(c);g(c);var h=e.core.controllerManager.controllers;-1===b.inArray(c,h)&&h.push(c);b(c.rootElement).trigger("h5controllerbound",[c]);h=f(c,"initPromise");h.push(c.initPromise);
b.when.apply(b,h).done(function(){A(c,!1)})}function ja(a){null===a.rootController&&H(a);P(a);A(a,!0)}function ka(a,b){var c=J();c.resolve();a.__controllerContext.templatePromise=c.promise();a.__controllerContext.initDfd=J();a.initPromise=a.__controllerContext.initDfd.promise();a.__controllerContext.readyDfd=J();a.readyPromise=a.__controllerContext.readyDfd.promise();a.isInit=!1;a.isReady=!1;a.__controllerContext.args=b;for(var h in a)v(a,h)&&ka(a[h])}function la(a,c){var h=null,d=c;b.isPlainObject(d)?
h=d.target:d={};h=h?F(h,a.rootElement,!0):a.rootElement;return e.ui.indicator.call(a,h,d)}function ma(a,c){var h=[],d=[],f=function(a){d.push(a);for(var e in a)if(v(a,e)){var g=a[e];-1===b.inArray(g,d)&&f(g)}a[c]&&b.isFunction(a[c])&&h.push(a[c]())};f(a);return h}function Ka(a){var c=[],h=function(a){c.push(a);Y("h5.core.view")&&a.view.clear();for(var d in a){if(v(a,d)){var f=a[d];-1===b.inArray(f,c)&&h(f)}a[d]=null}};h(a)}function S(a,b){return b.view.__view.isAvailable(a)?b.view.__view:b.parentController?
S(a,b.parentController):e.core.view}function K(a){this.__controller=a;Y("h5.core.view")&&(this.__view=e.core.view.createView())}function W(a,c,h,d){this.__name=c;this.__templates=null;this.rootElement=a;this.__controllerContext={executeListeners:!0,isRoot:d,bindMap:{},unbindMap:{}};h&&(this.__controllerContext.args=b.extend(!0,{},h));this.isReady=this.isInit=!1;this.readyPromise=this.initPromise=this.parentController=this.rootController=null;this.log=e.log.createLogger(c);this.view=new K(this)}function N(){this.rootElement=
document;this.controllers=[];b(document).bind("triggerIndicator",function(a,b){null==b.target&&(b.target=document);b.indicator=la(this,b);a.stopPropagation()})}function R(a,c,h,f){var e=c.__name;(!e||0===b.trim(e).length)&&i(ua,null,{controllerDefObj:c});h&&!b.isPlainObject(h)&&i(va,[e],{controllerDefObj:c});c.__controllerContext&&i(wa,null,{controllerDefObj:c});if(a){var g=b(a);0===g.length&&i(da,[e],{controllerDefObj:c});1<g.length&&i(ea,[e],{controllerDefObj:c})}y(c)&&i(xa,[e],{controllerDefObj:c});
o(c)&&i(ya,[e],{controllerDefObj:c});var m=!f||!f.isInternal,g=b.extend(!0,{},c),j=new W(a?b(a).get(0):null,e,h,m),x=c.__templates,r=J(),a=r.promise(),l=J(),m=l.promise();j.__controllerContext.templatePromise=a;j.preinitPromise=m;j.__controllerContext.initDfd=J();j.initPromise=j.__controllerContext.initDfd.promise();j.__controllerContext.readyDfd=J();j.readyPromise=j.__controllerContext.readyDfd.promise();if(x&&0<x.length){var n=function(a){Y("h5.core.view")||i(za);j.view.load(x).then(function(){r.resolve()},
function(b){var h=b.detail.error.status;a===X||0!==h&&12029!==h?(b.controllerDefObject=c,setTimeout(function(){r.reject(b)},0)):setTimeout(function(){n(++a)},La)})};n(0)}else r.resolve();a.done(function(){l.resolve()}).fail(function(a){l.reject(a);j.__controllerContext&&j.rootController.dispose()});for(var s in g)if(fa[s])i(Aa,[e,s],{controllerDefObj:c});else if(("__ready"===s||"__construct"===s||"__init"===s)&&b.isFunction(g[s]))j[s]=k(g,s);else if(-1!==s.indexOf(" ")&&b.isFunction(g[s])){m=b.trim(s).lastIndexOf(" ");
a=b.trim(s.substring(0,m));m=b.trim(s.substring(m+1,s.length));q(m)&&(m="["+b.trim(d(m))+"]");p(a)&&"this"===u(a)&&i(Ba,[e],{controllerDefObj:c});var w=j.__controllerContext.bindMap;w[a]||(w[a]={});w[a][m]&&i(Ca,[e,a,m],{controllerDefObj:c});var I=k(g,s,!0);w[a][m]=I;j[s]=I}else U(s,aa)&&g[s]&&!b.isFunction(g[s])?(a=R(null,b.extend(!0,{},g[s]),h,b.extend({isInternal:!0},f)),j[s]=a):U(s,ba)&&g[s]&&!b.isFunction(g[s])?(a=O(g[s]),j[s]=a):j[s]=b.isFunction(g[s])?k(g,s):g[s];if(h=j.__meta)for(s in h)a=
j[s],void 0===a&&i(Da,[e,s],{controllerDefObj:c}),null===a&&i(Ea,[e,s],{controllerDefObj:c}),W.prototype.constructor!==a.constructor&&i(Fa,[e,s],{controllerDefObj:c});j.__construct&&j.__construct({args:j.__controllerContext.args});if(!j.__controllerContext||j.__controllerContext.isDisposing)return null;j.__controllerContext.isRoot&&ja(j);return j}function O(a){var h=a.__name;(!h||0===b.trim(h.length))&&i(Ga,null,{logicDefObj:a});a.__logicContext&&i(Ha,null,{logicDefObj:a});var a=b.extend(!0,{},a),
d;for(d in a)a[d]=b.isFunction(a[d])?n(a[d],d,c(a.__name,d)):a[d];a.deferred=J;a.log=e.log.createLogger(h);a.__logicContext={};for(var f in a)a.hasOwnProperty(f)&&U(f,ba)&&(a[f]=O(a[f]));return a}var X=3,La=3E3,ra="undefined",aa="Controller",ba="Logic",Z="h5trackstart",oa="h5trackmove",ca="h5trackend",pa="rootElement",qa=6E3,ta=6001,sa=6002,da=6003,ea=6004,ua=6006,va=6007,wa=6008,xa=6009,ya=6010,Aa=6011,Ba=6012,Ca=6013,Da=6014,Ea=6015,Fa=6016,Ga=6017,Ha=6018,za=6029,C={};C[qa]='update/append/prepend() の第1引数に"window", "navigator", または"window.", "navigator."で始まるセレクタは指定できません。';
C[ta]="バインド対象となる要素を指定して下さい。";C[sa]="コントローラ化したオブジェクトを指定して下さい。";C[da]='コントローラ"{0}"のバインド対象となる要素が存在しません。';C[ea]='コントローラ"{0}"のバインド対象となる要素が2つ以上存在します。バインド対象は1つのみにしてください。';C[6005]="エラータイプを指定してください。";C[ua]="コントローラの名前が定義されていません。__nameにコントローラ名を設定して下さい。";C[va]='コントローラ"{0}"の初期化パラメータがプレーンオブジェクトではありません。初期化パラメータにはプレーンオブジェクトを設定してください。';C[wa]="指定されたオブジェクトは既にコントローラ化されています。";C[xa]='コントローラ"{0}"で、参照が循環しているため、コントローラを生成できません。';C[ya]='コントローラ"{0}"のロジックで、参照が循環しているため、ロジックを生成できません。';C[Aa]='コントローラ"{0}"のプロパティ"{1}"はコントローラ化によって追加されるプロパティと名前が重複しています。';
C[Ba]='コントローラ"{0}"でセレクタ名にthisが指定されています。コントローラをバインドした要素自身を指定したい時はrootElementを指定してください。';C[Ca]='コントローラ"{0}"のセレクタ"{1}"に対して"{2}"というイベントハンドラが重複して設定されています。';C[Da]='コントローラ"{0}"には__metaで指定されたプロパティ"{1}"がありません。';C[Ea]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値がnullです。コントローラを持つプロパティキー名を指定してください。';C[Fa]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値はコントローラではありません。コントローラを持つプロパティキー名を指定してください。';C[Ga]="ロジック名が定義されていません。__nameにロジック名を設定して下さい。";C[Ha]="指定されたオブジェクトは既にロジック化されています。";C[6019]="コントローラ、もしくはロジックの __name が設定されていません。";C[za]="テンプレートはViewモジュールがなければ使用できません。";
M(C);e.log.createLogger("h5.core");var J=e.async.deferred,V=e.u.str.startsWith,U=e.u.str.endsWith,Ia=e.u.str.format,ga=e.u.obj.argsToArray,Y=e.u.obj.getByPath;b.extend(K.prototype,{get:function(a,b){return S(a,this.__controller).get(a,b)},update:function(a,b,c){a=F(a,this.__controller.rootElement,!0);S(b,this.__controller).update(a,b,c)},append:function(a,b,c){a=F(a,this.__controller.rootElement,!0);S(b,this.__controller).append(a,b,c)},prepend:function(a,b,c){a=F(a,this.__controller.rootElement,
!0);S(b,this.__controller).prepend(a,b,c)},load:function(a){return this.__view.load(a)},register:function(a,b){this.__view.register(a,b)},isValid:function(a){return this.__view.isValid(a)},isAvailable:function(a){return S(a,this.__controller).isAvailable(a)},clear:function(a){this.__view.clear(a)}});b.extend(W.prototype,{$find:function(a){return b(this.rootElement).find(a)},deferred:function(){return J()},trigger:function(a,c){b(this.rootElement).trigger(a,[c])},own:function(a){var b=this;return function(){a.apply(b,
arguments)}},ownWithOrg:function(a){var b=this;return function(){var c=e.u.obj.argsToArray(arguments);c.unshift(this);a.apply(b,c)}},bind:function(a,c){this.rootElement=ia(a,null,this);this.view.__controller=this;var h=null;c&&(h=b.extend(!0,{},c));ka(this,h);ja(this);return this},unbind:function(){ma(this,"__unbind");r(this);w(this);this.__controllerContext.unbindMap={};var a=this.rootElement;e.core.controllerManager.controllers=b.grep(e.core.controllerManager.controllers,function(b){return b.rootElement!==
a});b(this.rootElement).trigger("h5controllerunbound");this.rootElement=null;this.view.__controller=null;ha(this)},dispose:function(){if(this.__controllerContext&&!this.__controllerContext.isDisposing){this.__controllerContext.isDisposing=1;var a=this.deferred();this.unbind();var c=this,h=ma(this,"__dispose");b.when.apply(b,h).done(function(){Ka(c);a.resolve()});return a.promise()}},triggerIndicator:function(a,c){var h=b.extend(!0,{},a),d=c;if(!d||0===d.length)d="triggerIndicator";b(this.rootElement).trigger(d,
[h]);return h.indicator},indicator:function(a){return la(this,a)},enableListeners:function(){t(this,!0)},disableListeners:function(){t(this,!1)},throwError:function(a,b){var c=null,c=a&&"string"===typeof a?Error(Ia.apply(null,ga(arguments))):Error.apply(null,arguments);c.customType=null;throw c;},throwCustomError:function(a,b,c){null==a&&i(6005);var h=ga(arguments);h.shift();error=b&&"string"===typeof b?Error(Ia.apply(null,ga(h))):Error.apply(null,h);error.customType=a;throw error;}});b.extend(N.prototype,
{getAllControllers:function(){return this.controllers},getController:function(a){for(var a=b(a).get(0),c=this.controllers,h=0,d=c.length;h<d;h++)if(a===c[h].rootElement)return c[h]}});e.u.obj.expose("h5.core",{controllerManager:new N});var fa={},C=new W(null,"a"),L;for(L in C)C.hasOwnProperty(L)&&"__name"!==L&&"__templates"!==L&&"__meta"!==L&&(fa[L]=1);C=W.prototype;for(L in C)C.hasOwnProperty(L)&&(fa[L]=1);e.u.obj.expose("h5.core",{controller:R,logic:O,expose:function(a){var b=a.__name;b||i(6019,
null,{target:a});var c=b.lastIndexOf(".");if(-1===c)window[b]=a;else{var h=b.substr(0,c),b=b.substr(c+1,b.length),c={};c[b]=a;e.u.obj.expose(h,c)}}})})();(function(){function l(a){return e.u.obj.isJQueryObject(a)?a:b(a)}function k(){this.__cachedTemplates={}}var c=7E3,n=7001,p=7002,q=7003,u={};u[c]="テンプレートをコンパイルできませんでした。{0}";u[n]="テンプレートファイルが不正です。{0}";u[p]="テンプレートIDが指定されていません。空や空白でない文字列で指定してください。";u[q]="テンプレートファイルを取得できませんでした。";u[7004]="テンプレートファイルの指定が不正です。空や空白でない文字列、または文字列の配列で指定してください。";u[7005]="テンプレートID:{0} テンプレートがありません。";
u[7006]="{0} テンプレートにパラメータが設定されていません。";M(u);var d="scriptタグが見つかりません。テンプレート文字列はscriptタグで囲って記述して下さい。",j="構文エラー {0}{1}",y="[";e.log.createLogger("h5.core.view");var o=e.async.deferred,v={escapeHtml:function(a){return e.u.str.escapeHtml(a)}},f={MAX_CACHE:10,cache:{},cacheUrls:[],accessingUrls:[],append:function(a,b,c){this.cacheUrls.length>=this.MAX_CACHE&&this.deleteCache(this.cacheUrls[0]);this.cache[a]={};this.cache[a].templates=b;this.cache[a].path=c;this.cacheUrls.push(a)},deleteCache:function(a,
b){b||delete this.cache[a];for(var c=0,d=this.cacheUrls.length;c<d;c++)if(this.cacheUrls[c]===a){this.cacheUrls.splice(c,1);break}},getTemplateByUrls:function(a){function f(a){if(0!==a.length){var h={},d=[];a.each(function(){var a=b.trim(this.id),f=b.trim(this.innerHTML);a||i(p,null,{});try{var g=new EJS.Compiler(f,y);g.compile();h[a]=g.process;d.push(a)}catch(m){f=m.lineNumber,i(c,[e.u.str.format(j,f?" line:"+f:"",m.message)],{id:a,error:m})}});return{compiled:h,data:{ids:d}}}}function g(a,c){var j=
c||0;if(a.length==j)h.resolve();else{var x=a[j],i=N(x);A.accessingUrls[i]||(A.accessingUrls[i]=e.ajax(x));A.accessingUrls[i].then(function(c,e,x){delete A.accessingUrls[i];c=b(x.responseText).filter(function(){return this.tagName&&-1===this.tagName.indexOf("/")&&8!==this.nodeType});e=this.url;0<c.not('script[type="text/ejs"]').length&&h.reject(K(n,[d],{url:i,path:e}));x=null;try{x=f(c.filter('script[type="text/ejs"]'))}catch(l){l.detail.url=i,l.detail.path=e,h.reject(l)}try{var o=x.compiled,I=x.data;
I.path=e;I.absoluteUrl=i;b.extend(k,o);v.push(I);A.append(i,o,e);g(a,++j)}catch(t){h.reject(K(n,null,{error:t,url:i,path:e}))}}).fail(function(a){h.reject(K(q,null,{url:i,path:x,error:a}))});return h.promise()}}for(var k={},l=[],v=[],A=this,u=function(a){var b=A.cache[a].templates;A.deleteCache(a,!0);A.cacheUrls.push(a);return b},E=0;E<a.length;E++){var B=a[E],F=N(B);this.cache[F]?(b.extend(k,u(F)),v.push({absoluteUrl:F})):l.push(B)}var h=o(),x=o();b.when(g(l)).done(function(){x.resolve(k,v)}).fail(function(a){x.reject(a)});
return x.promise()}};b.extend(k.prototype,{load:function(a){var c=o(),d=this,e=null;switch(b.type(a)){case "string":b.trim(a)||i(7004);e=[a];break;case "array":e=a;0===e.length&&i(7004);for(var a=0,g=e.length;a<g;a++)"string"!==typeof e[a]?i(7004):b.trim(e[a])||i(7004);break;default:i(7004)}f.getTemplateByUrls(e).done(function(a,e){b.extend(d.__cachedTemplates,a);c.resolve(e)}).fail(function(a){c.reject(a)});return c.promise()},getAvailableTemplates:function(){var a=[],b;for(b in this.__cachedTemplates)a.push(b);
return a},register:function(a,d){"string"!==b.type(d)?i(c,["テンプレートには文字列を指定してください"],{id:a}):("string"!==typeof a||!b.trim(a))&&i(p,[]);try{var f=new EJS.Compiler(d,y);f.compile();this.__cachedTemplates[a]=f.process}catch(g){f=g.lineNumber,i(c,[e.u.str.format(j,f?" line:"+f:"",g.message)],{id:a})}},isValid:function(a){try{return(new EJS.Compiler(a,y)).compile(),!0}catch(b){return!1}},get:function(a,c){var d=this.__cachedTemplates;if(b.isEmptyObject(d))return null;("string"!==typeof a||!b.trim(a))&&
i(p);(d=d[a])||i(7005,a);var f=c?b.extend(!0,{},c):{},e=f.hasOwnProperty("_h")?new EJS.Helpers(f):new EJS.Helpers(f,{_h:v}),g=null;try{g=d.call(f,f,e)}catch(j){i(7006,j.toString(),j)}return g},update:function(a,b,c){return l(a).html(this.get(b,c))},append:function(a,b,c){return l(a).append(this.get(b,c))},prepend:function(a,b,c){return l(a).prepend(this.get(b,c))},isAvailable:function(a){return!!this.__cachedTemplates[a]},clear:function(a){if(void 0===a)this.__cachedTemplates={};else{var c=null;switch(b.type(a)){case "string":c=
[a];break;case "array":a.length||i(p);c=a;break;default:i(p)}for(var a=0,d=c.length;a<d;a++){var f=c[a];("string"!==typeof f||!b.trim(f))&&i(p)}a=0;for(d=c.length;a<d;a++)delete this.__cachedTemplates[c[a]]}}});var g=new k;g.createView=function(){return new k};b(function(){b('script[type="text/ejs"]').each(function(){var a=b.trim(this.id),c=b.trim(this.innerHTML);0!==c.length&&a&&(c=new EJS.Compiler(c,y),c.compile(),g.__cachedTemplates[a]=c.process)})});e.u.obj.expose("h5.core",{view:g})})();(function(){function i(c){var d=
{},a;for(a in j){var e=b("<div></div>").addClass(c).addClass(a).appendTo("body"),k=b.camelCase(a);d[k]={};b.map(j[a],function(a){d[k][a]="width"===a||"height"===a?parseInt(e.css(a).replace(/\D/g,""),10):e.css(a)});e.remove()}return d}function k(b,c){var a=window.document.createElement("v:"+b),d;for(d in c)a.style[d]=c[d];return a}function c(b,c){for(var a=[],d=b/2,e=0.8*b/2,j=360/c*Math.PI/180,k=1;k<=c;k++){var i=j*k,l=Math.cos(i),i=Math.sin(i);a.push({from:{x:d+e/2*l,y:d+e/2*i},to:{x:d+e*l,y:d+e*
i}})}return a}function n(d){this.style=b.extend(!0,{},d);d=this.style.throbber.width;this.group=k("group",{width:d+"px",height:this.style.throbber.height+"px"});this.group.className=q;for(var d=c(d,this.style.throbber.lines),e=this.style.throbberLine.color,a=this.style.throbberLine.width,j=0,i=d.length;j<i;j++){var l=d[j],n=l.from,o=l.to,l=k("line");l.strokeweight=a;l.strokecolor=e;l.fillcolor=e;l.from=n.x+","+n.y;l.to=o.x+","+o.y;n=k("stroke");n.opacity=1;l.appendChild(n);this.group.appendChild(l)}this._createPercentArea()}
function p(c,g){b.blockUI.defaults.css={};b.blockUI.defaults.overlayCSS={};this.target=e.u.obj.isJQueryObject(c)?c.get(0):c;var a=this,j=this._isGlobalBlockTarget()?b("body"):b(this.target),k=j.css("position"),r=j.css("zoom"),t=b.extend(!0,{},{message:"",percent:-1,block:!0,promises:null,theme:"a"},g),p={message:e.u.str.format(u,""===t.message?'style="display: none;"':"",t.message),css:{},overlayCSS:{},blockMsgClass:t.theme,showOverlay:t.block,centerX:!1,centerY:!1,onUnblock:function(){j.css("position",
k);j.css("zoom",r);a.throbber.hide()}},q={throbber:{roundTime:1E3,lines:12},throbberLine:{},percent:{}},D=t.promises,E=b.proxy(function(){this.hide()},this);b.isArray(D)?(b.map(D,function(a){return d(a)?a:null}),0<D.length&&b.when.apply(null,D).pipe(E,E)):d(D)&&D.pipe(E,E);D=i(t.theme);q=b.extend(!0,q,D);this._style=b.extend(!0,{},p,q);y?this.throbber=new v(this._style):o&&(this.throbber=new n(this._style));this.throbber&&-1<t.percent&&this.throbber.setPercent(t.percent)}var q="vml-root",u='<span class="indicator-throbber"></span><span class="indicator-message" {0}>{1}</span>',
d=e.async.isPromise,j={throbber:["width","height"],"throbber-line":["width","color"]},y=!0,o=e.env.ua.isIE;b(function(){y=!!document.createElement("canvas").getContext;!y&&o&&(document.namespaces.add("v","urn:schemas-microsoft-com:vml"),document.createStyleSheet().cssText="v\\:stroke,v\\:line,v\\:textbox{behavior: url(#default#VML);}")});n.prototype={show:function(b){b&&(this.root=b,this.highlightPos=1,this.hide(),this.root.appendChild(this.group),this._run())},hide:function(){this.root.innerHTML=
"";this._runId&&(clearTimeout(this._runId),this._runId=null)},_run:function(){for(var b=this.style.throbber.lines,c=this.style.throbber.roundTime,a=this.highlightPos,d=this.group.childNodes,e=0,j=d.length;e<j;e++){var k=d[e];if("textbox"!==k.nodeName){var i=e+1;k.firstChild.opacity=i==a?"1":i==a+1||i==a-1?"0.75":"0.4"}}a==b?a=0:a++;this.highlightPos=a;var l=this;this._runId=setTimeout(function(){l._run.call(l)},Math.floor(c/b))},_createPercentArea:function(){var c=k("textbox"),d=b("<table><tr><td></td></tr></table>"),
a=d.find("td");a.width(this.group.style.width);a.height(this.group.style.height);a.css("line-height",this.group.style.height);a.addClass("throbber-percent");c.appendChild(d[0]);this.group.appendChild(c)},setPercent:function(c){b(this.group).find(".throbber-percent").html(c)}};var v=function(d){this.style=b.extend(!0,{},d);this.canvas=document.createElement("canvas");this.baseDiv=document.createElement("div");this.percentDiv=document.createElement("div");var d=this.canvas,e=this.baseDiv,a=this.percentDiv;
d.width=this.style.throbber.width;d.height=this.style.throbber.height;d.style.display="block";d.style.position="absolute";e.style.width=this.style.throbber.width+"px";e.style.height=this.style.throbber.height+"px";e.appendChild(d);a.style.width=this.style.throbber.width+"px";a.style.height=this.style.throbber.height+"px";a.style.lineHeight=this.style.throbber.height+"px";a.className="throbber-percent";e.appendChild(a);this.positions=c(d.width,this.style.throbber.lines)};v.prototype={show:function(b){b&&
(this.root=b,this.highlightPos=1,this.hide(),this.root.appendChild(this.baseDiv),this._run())},hide:function(){b(this.baseDiv).remove();this._runId&&(clearTimeout(this._runId),this._runId=null)},_run:function(){var b=this.canvas,c=b.getContext("2d"),a=this.highlightPos,d=this.positions,e=this.style.throbberLine.color,j=this.style.throbberLine.width,k=this.style.throbber.lines,i=this.style.throbber.roundTime;b.width=b.width;for(var b=0,l=d.length;b<l;b++){c.beginPath();c.strokeStyle=e;c.lineWidth=
j;var n=b+1;c.globalAlpha=n==a?1:n==a+1||n==a-1?0.75:0.4;var o=d[b],n=o.from,o=o.to;c.moveTo(n.x,n.y);c.lineTo(o.x,o.y);c.stroke()}a==k?a=0:a++;this.highlightPos=a;var y=this;this._runId=setTimeout(function(){y._run.call(y)},Math.floor(i/k))},setPercent:function(b){this.percentDiv.innerHTML=b}};p.prototype={show:function(){var c=this._style,d=null;this._isGlobalBlockTarget()?(b.blockUI(c),d=b("body").children(".blockUI."+c.blockMsgClass+".blockPage")):(d=b(this.target),d.block(c),d=d.children(".blockUI."+
c.blockMsgClass+".blockElement"));this.throbber.show(d.children(".indicator-throbber")[0]);this._setPositionAndResizeWidth();return this},_setPositionAndResizeWidth:function(){var c=this._style,d=null,a=null,e=0;this._isGlobalBlockTarget()?(d=b("body"),a=d.children(".blockUI."+c.blockMsgClass+".blockPage"),a.css("top",(b(window).height()-a.outerHeight())/2+"px")):(d=b(this.target),a=d.children(".blockUI."+c.blockMsgClass+".blockElement"),a.css("top",(d.height()-a.outerHeight())/2+"px"));c=a.innerWidth()-
a.width();a.children().each(function(){e=e+b(this).outerWidth(true)});a.width(e+c);a.css("left",(d.width()-a.outerWidth())/2+"px")},_isGlobalBlockTarget:function(){return this.target===document||this.target===window||this.target===document.body},hide:function(){this._isGlobalBlockTarget()?b.unblockUI():b(this.target).unblock();return this},percent:function(b){"number"===typeof b&&0<=b&&100>=b&&this.throbber.setPercent(b);return this},message:function(c){if("string"===typeof c){var d=this._style,a=
null,a=this._isGlobalBlockTarget()?b("body").children(".blockUI."+d.blockMsgClass+".blockPage"):b(this.target).children(".blockUI."+d.blockMsgClass+".blockElement");a.children(".indicator-message").css("display","inline-block").text(c);this._setPositionAndResizeWidth()}return this}};e.u.obj.expose("h5.ui",{indicator:function(b,c){return new p(b,c)},isInView:function(c,d){var a,j,k,i,l=b(c);if(void 0===d)j=e.env.ua.isiOS?window.innerHeight:b(window).height(),i=e.env.ua.isiOS?window.innerWidth:b(window).width(),
a=b(window).scrollTop(),k=b(window).scrollLeft();else{i=b(d);if(0===i.find(l).length)return;a=i.offset().top+parseInt(i.css("border-top-width"));k=i.offset().left+parseInt(i.css("border-left-width"));j=i.innerHeight();i=i.innerWidth()}j=a+j;i=k+i;var n=l.offset().top,o=l.offset().left,y=n+l.outerHeight(),l=o+l.outerWidth();return(a<=n&&n<j||a<y&&y<=j)&&(k<=o&&o<i||k<l&&l<=i)},scrollToTop:function(){function c(){1===window.scrollY&&(d=0);0<d&&(window.scrollTo(0,1),d--,setTimeout(c,a))}var d=3,a=500;
window.scrollTo(0,1);1!==b(window).scrollTop&&setTimeout(c,a)}})})();(function(){function i(){var d=b.mobile.activePage;if(d){var d=d.attr("id"),e=n[d];if(c[d]&&(!e||0===e.length))k.addCSS(d),k.bindController(d)}}e.log.createLogger("h5.ui.jqm.manager");var k=null,c={},n={},p={},q={};e.u.obj.ns("h5.ui.jqm");e.ui.jqm.dataPrefix="h5";var u={__name:"JQMController",__ready:function(){var c=this;b(':jqmData(role="page"), :jqmData(role="dialog")').each(function(){c.loadScript(this.id)})},':jqmData(role="page"), :jqmData(role="dialog") pageinit':function(b){b=
b.event.target.id;this.loadScript(b);this.addCSS(b);this.bindController(b)},"{document} pageremove":function(b){var b=b.event.target.id,c=n[b];if(c){for(var e=0,k=c.length;e<k;e++)c[e].dispose();n[b]=[]}},"{document} pagebeforeshow":function(b){b=b.event.target.id;this.addCSS(b);for(var c in n)for(var e=n[c],k=b===c,i=0,f=e.length;i<f;i++){var g=e[i];k?g.enableListeners():g.disableListeners()}},"{document} pagehide":function(b){this.removeCSS(b.event.target.id)},"{rootElement} h5controllerbound":function(b){var c=
b.event.target.id;n[c]||(n[c]=[]);n[c].push(b.evArg)},loadScript:function(c){var c=b("#"+c),j=b.trim(c.data(this.getDataAttribute("script")));if(0!==j.length)return j=b.map(j.split(","),function(c){return b.trim(c)}),c=!0==c.data(this.getDataAttribute("async")),e.u.loadScript(j,{async:c})},getDataAttribute:function(b){var c=e.ui.jqm.dataPrefix;null==c&&(c="h5");return 0!==c.length?c+"-"+b:b},bindController:function(b){var j=n[b];c[b]&&!(j&&0<j.length)&&e.core.controller("#"+b,c[b],p[b])},addCSS:function(c){var e=
q[c];if(e)for(var k=document.getElementsByTagName("head")[0],i=k.getElementsByTagName("link"),l=i.length,e=B(e),f=0,e=e.length;f<e;f++){for(var g=b.mobile.path.parseUrl(q[c][f]).filename,a=!1,m=0;m<l;m++)if(b.mobile.path.parseUrl(i[m].href).filename===g){a=!0;break}a||(g=document.createElement("link"),g.type="text/css",g.rel="stylesheet",g.href=q[c][f],k.appendChild(g))}},removeCSS:function(c){if(c=q[c]){var e=b.mobile.activePage.attr("id"),e=q[e],k=B(c),i=B(e);b("link").filter(function(){var c=b(this).attr("href");
return-1!==b.inArray(c,k)&&-1===b.inArray(c,i)}).remove()}}};e.u.obj.expose("h5.ui.jqm.manager",{init:function(){b(function(){k||(k=e.core.controller("body",u));i()})},define:function(b,j,n,o){c[b]=n;p[b]=o;q[b]=B(j);!k?e.ui.jqm.manager.init():i()}})})();(function(){function l(){n||(n=navigator.geolocation);return n}function k(b,c){this.oblateness=b;this.semiMajorAxis=c}function c(){}M({2E3:"正しい緯度または経度を指定して下さい。",2001:"正しい計算モード定数を指定して下さい",2002:"位置情報の取得に失敗しました。"});var n=null,p=e.env.ua;k.prototype.getOblateness=
function(){return this.oblateness};k.prototype.getSemiMajorAxis=function(){return this.semiMajorAxis};var q=new k(298.257222,6378137),u=new k(299.152813,6377397.155),d=Math.PI/180;b.extend(c.prototype,{isSupported:p.isIE&&9<=p.browserVersion?!0:!!l(),getCurrentPosition:function(b){var c=e.async.deferred();l().getCurrentPosition(function(b){c.resolve(b)},function(b){c.reject(K(2002,null,b))},b);return c.promise()},watchPosition:function(b){function c(){}var d=e.async.deferred(),k=l().watchPosition(function(b){d.notify(b)},
function(b){d.reject(K(2002,null,b))},b);c.prototype.unwatch=function(){l().clearWatch(k);d.resolve()};return d.promise(new c)},getDistance:function(b,c,e,l,f){if(!isFinite(b)||!isFinite(c)||!isFinite(e)||!isFinite(l))throw new i(2E3);var g=f?f:q;if(!(g instanceof k))throw new i(2001);var f=g.getSemiMajorAxis(),a=g.getOblateness(),b=b*d,c=c*d,e=e*d,g=l*d,l=(b+e)/2,a=Math.sqrt(2*a-1)/a,a=Math.pow(a,2),m=Math.sqrt(1-a*Math.pow(Math.sin(l),2)),a=f*(1-a)/Math.pow(m,3),f=f/m,c=c-g;return Math.sqrt(Math.pow(a*
(b-e),2)+Math.pow(f*Math.cos(l)*c,2))},GS_GRS80:q,GS_BESSEL:u});e.u.obj.expose("h5.api",{geo:new c})})();(function(){function l(a){switch(a.code){case a.CONSTRAINT_ERR:return"一意制約に反しています。";case a.DATABASE_ERR:return"データベースエラー";case a.QUOTA_ERR:return"空き容量が不足しています。";case a.SYNTAX_ERR:return"構文に誤りがあります。";case a.TIMEOUT_ERR:return"ロック要求がタイムアウトしました。";case a.TOO_LARGE_ERR:return"取得結果の行が多すぎます。";case a.UNKNOWN_ERR:return"トランザクション内で例外がスローされました。";case a.VERSION_ERR:return"データベースのバージョンが一致しません。"}}function k(a,
b){for(var c=a._tasks,d=c.length-1;0<=d;d--){var e=c[d],f=l(b);e.deferred.reject(K(D,[f,b.message],b))}}function c(a){for(var a=a._tasks,b=a.length-1;0<=b;b--){var c=a[b];c.deferred.resolve(c.result)}}function n(a){if(a)throw new i(r);}function p(a,b){if("string"!==typeof b)throw new i(t,a);}function q(a,b){if(void 0!==b&&!(b instanceof j))throw new i(H,a);}function u(a,c,d){if(b.isPlainObject(a))for(var e in a){var f=b.trim(e).replace(/ +/g," ").split(" "),g=[];if(""===f[0])throw new i(E);if(1===
f.length)g.push(f[0]),g.push("="),g.push("?");else if(/^(<=|<|>=|>|=|!=|like)$/i.test(f[1]))3===f.length&&/^like$/i.test(f[1])?(g.push(f[0]),g.push(f[1]),g.push("?"),g.push("ESCAPE"),g.push('"'+f[2]+'"')):(g.push(f[0]),g.push(f[1]),g.push("?"));else throw new i(A);c.push(g.join(" "));d.push(a[e])}}function d(){}function j(a,b){this._db=a;this._tx=b;this._tasks=[]}function y(a,c,d){this._txw=a;this._tableName=c;this._columns=b.isArray(d)?d.join(", "):"*";this._statement=this._orderBy=this._where=null;
this._params=[];this._df=F();this._executed=!1}function o(a,b,c){this._txw=a;this._tableName=b;this._values=c?B(c):[];this._statement=[];this._params=[];this._df=F();this._executed=!1}function v(a,b,c){this._txw=a;this._tableName=b;this._value=c;this._statement=this._where=null;this._params=[];this._df=F();this._executed=!1}function f(a,b){this._txw=a;this._tableName=b;this._statement=this._where=null;this._params=[];this._df=F();this._executed=!1}function g(a,b,c){this._txw=a;this._statement=b;this._params=
c||[];this._df=F();this._executed=!1}function a(a){this._txw=a;this._queue=[];this._df=F();this._executed=!1}function m(a){this._db=a}function w(){}var r=3E3,t=3001,H=3002,A=3003,D=3010,E=3011,G={};G[r]="同一オブジェクトによるSQLの再実行はできません。";G[t]="{0}: テーブル名を指定して下さい。";G[H]="{0}: トランザクションが不正です。";G[A]="オペレータが不正です。 <= < >= > = != like のいずれかを使用して下さい。";G[3004]="{0}: {1}に指定したオブジェクトの型が不正です。";G[3005]="{0}: カラム名を指定して下さい。";G[3006]="{0}: 値を指定して下さい。";G[3007]="{0}: ステートメントが不正です。";G[3008]="{0}: パラメータは配列で指定して下さい。";G[3009]=
"指定されたオブジェクトはトランザクションに追加できません。Insert/Update/Del/Select/Sqlクラスのインスタンスを指定して下さい。";G[D]="トランザクション処理中にエラーが発生しました。{0} {1}";G[E]="where句に指定されたカラム名が空白または空文字です。";M(G);var F=e.async.deferred;b.extend(j.prototype,{_runTransaction:function(){return null!=this._tx},_execute:function(a,b,c){this._runTransaction()?this._tx.executeSql(a,b,c):this._db.transaction(a,b,c)},_addTask:function(a){this._tasks.push({deferred:a,result:null})},_setResult:function(a){this._tasks[this._tasks.length-1].result=a}});y.prototype=
new d;b.extend(y.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new i(3004,["Select","where"]);this._where=a;return this},orderBy:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new i(3004,["Select","orderBy"]);this._orderBy=B(a);return this},execute:function(){var a=this,d=function(){var c=a._params,d=a._where,f=a._orderBy,g=e.u.str.format("SELECT {0} FROM {1}",a._columns,a._tableName);if(b.isPlainObject(d)){var k=[];u(d,k,c);g+=" WHERE "+k.join(" AND ")}else"string"===
typeof d&&(g+=" WHERE "+d);b.isArray(f)&&(g+=" ORDER BY "+f.join(", "));a._statement=g},f=F(),g=this._txw,i=this._executed,j=null;g._runTransaction()?(g._addTask(f),d(),n(i),g._execute(this._statement,this._params,function(a,b){j=b.rows;g._setResult(j);f.notify(j,g)})):g._execute(function(b){g._addTask(f);d();n(i);g._tx=b;b.executeSql(a._statement,a._params,function(a,b){j=b.rows;g._setResult(j);f.notify(j,g)})},function(a){k(g,a)},function(){c(g)});this._executed=!0;return f.promise()}});o.prototype=
new d;b.extend(o.prototype,{execute:function(){function a(){d._statement.length===o?(l=m,i._setResult(l),g.notify(l,i)):i._execute(d._statement[o],d._params[o],function(b,c){o++;m.push(c.insertId);a()})}var d=this,f=function(){var a=d._values;if(0===a.length)d._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",d._tableName)),d._params.push([]);else for(var c=0,h=a.length;c<h;c++){var f=a[c];if(null==f)d._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",d._tableName)),d._params.push([]);
else if(b.isPlainObject(f)){var g=[],i=[],k=[],j;for(j in f)g.push("?"),i.push(j),k.push(f[j]);d._statement.push(e.u.str.format("INSERT INTO {0} ({1}) VALUES ({2})",d._tableName,i.join(", "),g.join(", ")));d._params.push(k)}}},g=F(),i=this._txw,j=this._executed,l=null,m=[],o=0;i._runTransaction()?(i._addTask(g),f(),n(j),a()):i._execute(function(b){i._addTask(g);f();n(j);i._tx=b;a()},function(a){k(i,a)},function(){c(i)});this._executed=!0;return g.promise()}});v.prototype=new d;b.extend(v.prototype,
{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new i(3004,["Update","where"]);this._where=a;return this},execute:function(){var a=this,d=function(){var c=a._where,d=a._value,g=[],f;for(f in d)g.push(f+" = ?"),a._params.push(d[f]);a._statement=e.u.str.format("UPDATE {0} SET {1}",a._tableName,g.join(", "));b.isPlainObject(c)?(d=[],u(c,d,a._params),a._statement+=" WHERE "+d.join(" AND ")):"string"===typeof c&&(a._statement+=" WHERE "+c)},f=F(),g=this._txw,i=this._executed,j=null;
g._runTransaction()?(g._addTask(f),d(),n(i),g._execute(this._statement,this._params,function(a,b){j=b.rowsAffected;g._setResult(j);f.notify(j,g)})):g._execute(function(b){g._addTask(f);d();n(i);g._tx=b;b.executeSql(a._statement,a._params,function(a,b){j=b.rowsAffected;g._setResult(j);f.notify(j,g)})},function(a){k(g,a)},function(){c(g)});this._executed=!0;return f.promise()}});f.prototype=new d;b.extend(f.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new i(3004,["Del",
"where"]);this._where=a;return this},execute:function(){var a=this,d=function(){var c=a._where;a._statement=e.u.str.format("DELETE FROM {0}",a._tableName);if(b.isPlainObject(c)){var d=[];u(c,d,a._params);a._statement+=" WHERE "+d.join(" AND ")}else"string"===typeof c&&(a._statement+=" WHERE "+c)},g=F(),f=this._txw,i=this._executed,j=null;f._runTransaction()?(f._addTask(g),d(),n(i),f._execute(this._statement,this._params,function(a,b){j=b.rowsAffected;f._setResult(j);g.notify(j,f)})):f._execute(function(b){f._addTask(g);
d();n(i);f._tx=b;b.executeSql(a._statement,a._params,function(a,b){j=b.rowsAffected;f._setResult(j);g.notify(j,f)})},function(a){k(f,a)},function(){c(f)});return g.promise()}});g.prototype=new d;b.extend(g.prototype,{execute:function(){var a=F(),b=this._txw,d=this._executed,e=this._statement,f=this._params,g=null;b._runTransaction()?(b._addTask(a),n(d),b._execute(e,f,function(c,d){g=d;b._setResult(g);a.notify(g,b)})):b._execute(function(c){b._addTask(a);n(d);b._tx=c;c.executeSql(e,f,function(c,d){g=
d;b._setResult(g);a.notify(g,b)})},function(a){k(b,a)},function(){c(b)});this._executed=!0;return a.promise()}});a.prototype=new d;b.extend(a.prototype,{add:function(a){if(!(a instanceof d))throw new i(3009);this._queue.push(a);return this},execute:function(){function a(b){function c(a){this._txw=new j(null,a)}for(var d=[],e=0,f=g.length;e<f;e++)c.prototype=g[e],d.push(new c(b));return d}function b(){if(l.length===i){for(var a=[],c=0,f=l.length;c<f;c++)a.push(l[c]._txw._tasks[0].result);e._setResult(a);
d.notify(a,e)}else l[i].execute().progress(function(){i++;b()})}var d=this._df,e=this._txw,g=this._queue,f=this._executed,i=0,l=null;e._runTransaction()?(e._addTask(d),n(f),l=a(e._tx),b()):e._execute(function(c){e._addTask(d);n(f);l=a(c);e._tx=c;b()},function(a){k(e,a)},function(){c(e)});this._executed=!0;return d.promise()},promise:function(){return this._df.promise()}});b.extend(m.prototype,{select:function(a,c,d){p("select",a);q("select",d);if(!b.isArray(c)&&"*"!==c)throw new i(3005,"select");
return new y(d?d:new j(this._db,null),a,c)},insert:function(a,c,d){p("insert",a);q("insert",d);if(null!=c&&!b.isArray(c)&&!b.isPlainObject(c))throw new i(3006,"insert");return new o(d?d:new j(this._db,null),a,c)},update:function(a,c,d){p("update",a);q("update",d);if(!b.isPlainObject(c))throw new i(3006,"update");return new v(d?d:new j(this._db,null),a,c)},del:function(a,b){p("del",a);q("del",b);return new f(b?b:new j(this._db,null),a)},sql:function(a,c,d){q("sql",d);if("string"!==typeof a)throw new i(3007,
"sql");if(null!=c&&!b.isArray(c))throw new i(3008,"sql");return new g(d?d:new j(this._db,null),a,c)},transaction:function(b){q("sql",b);return new a(b?b:new j(this._db,null))}});b.extend(w.prototype,{isSupported:!!window.openDatabase,open:function(a,b,c,d){if(this.isSupported)return a=openDatabase(a,b,c,d),new m(a)}});e.u.obj.expose("h5.api",{sqldb:new w})})();(function(){function i(b){this._storage=b}e.log.createLogger("h5.api.storage");b.extend(i.prototype,{getLength:function(){return this._storage.length},
key:function(b){return this._storage.key(b)},getItem:function(b){return e.u.obj.deserialize(this._storage.getItem(b))},setItem:function(b,c){this._storage.setItem(b,e.u.obj.serialize(c))},removeItem:function(b){this._storage.removeItem(b)},clear:function(){this._storage.clear()},each:function(b){for(var c=this._storage,e=0,i=c.length;e<i;e++){var l=c.key(e);b(e,l,this.getItem(l))}}});e.u.obj.expose("h5.api.storage",{isSupported:!!window.localStorage,local:new i(window.localStorage),session:new i(window.sessionStorage)})})()})(jQuery);
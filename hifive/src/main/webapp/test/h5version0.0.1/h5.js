/* Copyright (C) 2012 NS Solutions Corporation. Licensed under the Apache License, Version 2.0. hifive version 0.0.1 (util,controller,view,ui,api.geo,api.sqldb,api.storage) */
(function(b){function h(b,h,l){var c=Error();b&&(c.code=b);if(b=V[b])h=[b].concat(h),c.message=e.u.str.format.apply(null,h);l&&(c.detail=l);throw c;}function N(b){for(code in b)b.hasOwnProperty(code)&&(V[code]=b[code])}function K(b,h,l){var c=null,m=V[b];m&&(h=[m].concat(h),c=e.u.str.format.apply(null,h));return{code:b,message:c,detail:l}}function z(e){return null==e?e:b.isArray(e)?e:[e]}function L(b){var e=document.createElement("span");e.innerHTML='<a href="'+b+'" />';return e.firstChild.href}function S(e){if("regexp"===
b.type(e))return e;var h="",h=-1!==e.indexOf("*")?b.map(e.split("*"),function(b){return b.replace(/\W/g,"\\$&")}).join(".*"):e;return RegExp("^"+h+"$")}var W=void 0;if(window.h5){if(window.h5.env&&"0.0.1"===window.h5.env.version)return;W=window.h5}var e={};window.h5=e;e.coexist=function(){window.h5=W;return e};e.env={version:"0.0.1"};var V={};(function(){function o(b){switch(b){case "string":return"s";case "number":return"n";case "boolean":return"b";case "String":return"S";case "Number":return"N";
case "Boolean":return"B";case "infinity":return"i";case "-infinity":return"I";case "nan":return"x";case "date":return"d";case "regexp":return"r";case "array":return"a";case "object":return"o";case "null":return"l";case n:return"u";case "undefElem":return"_";case "objElem":return"@"}}var n="undefined",l=11004,c=11005,m=11006,r={11E3:"{0} 第一引数には空文字で無い文字列を指定して下さい。",11001:'名前空間"{0}"には、プロパティ"{1}"が既に存在します。',11002:"Function型のオブジェクトは変換できません。",11003:"シリアライザのバージョンが違います。シリアライズされたバージョン：{0} 現行のバージョン：{1}"};r[l]=
"型指定子が不正です。";r[c]="循環参照が含まれています。";r[m]="不正な値が含まれるため、デシリアライズできませんでした。";r[11007]="スクリプトのパスが不正です。空文字以外の文字列、またはその配列を指定して下さい。";r[11008]="{0} オプションの指定が不正です。プレーンオブジェクトで指定してください。";r[11009]="deserialize() 引数の値が不正です。引数には文字列を指定してください。";N(r);var s=[],x={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;","'":"&apos;"},k=function(g){g||h(11E3,"h5.u.obj.ns()");"string"!==b.type(g)&&h(11E3,"h5.u.obj.ns()");for(var g=g.split("."),c=window,f=0,d=g.length;f<d;f++)void 0===c[g[f]]&&(c[g[f]]={}),c=c[g[f]];return c},r=function(b,
c){var f=k(b),d;for(d in c)c.hasOwnProperty(d)&&(f[d]&&h(11001,b,d),f[d]=c[d])};r("h5.u",{loadScript:function(g,c){var f=z(g);(!f||0===f.length)&&h(11007);for(var d=0,p=f.length;d<p;d++)g=f[d],("string"!==typeof g||!b.trim(g))&&h(11007);null!=c&&!b.isPlainObject(c)&&h(11008,"h5.u.loadScript()");var a=c&&!0===c.force,i=f.length;if(!c||!0!==c.async){p=b("head");for(d=0;d<i;d++){var v=L(f[d]);if(a||-1===b.inArray(v,s))p.append('<script type="text/javascript" src="'+v+'"><\/script>'),s.push(v)}}else{var k=
c&&!0===c.parallel,m=[],B=e.async.deferred(),q=document.head||document.getElementsByTagName("head")[0],o=function(d){var c=d;if(i<=c)e.async.when.apply(b,m).done(function(){B.resolve()});else if(d=L(f[c]),!a&&-1!==b.inArray(d,s))o(++c);else{var g=document.createElement("script");g.type="text/javascript";var p=k?e.async.deferred():null;window.ActiveXObject?g.onreadystatechange=function(){if("complete"==g.readyState||"loaded"==g.readyState)g.onreadystatechange=null,p?p.resolve():o(++c)}:(g.onerror=
function(){g.onerror=null;p?p.resolve():o(++c)},g.onload=function(){g.onload=null;p?p.resolve():o(++c)});g.src=d;q.appendChild(g);s.push(d);p&&(m.push(p.promise()),o(++c))}};setTimeout(function(){o(0)},0);return B.promise()}},createInterceptor:function(b,c){return function(f){var d={},p=b?b.call(this,f,d):f.proceed();f.result=p;if(!c)return p;if(e.async.isPromise(p)){var a=this;p.always(function(){c.call(a,f,d)});return p}c.call(this,f,d);return p}}});r("h5.u.str",{startsWith:function(b,c){return 0===
b.lastIndexOf(c,0)},endsWith:function(b,c){var f=b.length-c.length;return 0<=f&&b.lastIndexOf(c)===f},format:function(b,c){if(null==b)return"";var f=arguments;return b.replace(/\{(\d+)\}/g,function(b,c){var a=f[parseInt(c,10)+1];return typeof a===n?n:a})},escapeHtml:function(c){return"string"!==b.type(c)?c:c.replace(/[&"'<>]/g,function(b){return x[b]})}});r("h5.u.obj",{expose:r,ns:k,serialize:function(g){function e(b){for(var d=0,c=p.length;d<c;d++)if(b===p[d])return!0;return!1}function f(b){for(var d=
0,c=p.length;d<c;d++)b===p[d]&&p.splice(d,1)}function d(a){var i=a,g=b.type(a);"object"===typeof a&&(a instanceof String?g="String":a instanceof Number?g="Number":a instanceof Boolean&&(g="Boolean"));switch(g){case "String":case "string":i=o(g)+i;break;case "Boolean":i=i.valueOf();case "boolean":i=o(g)+(i?1:0);break;case "Number":i=i.valueOf();if(b.isNaN&&b.isNaN(a)||b.isNumeric&&!b.isNumeric(a))i=Infinity===a.valueOf()?o("infinity"):-Infinity===a.valueOf()?o("-infinity"):o("nan");i=o(g)+i;break;
case "number":i=b.isNaN&&b.isNaN(a)||b.isNumeric&&!b.isNumeric(a)?Infinity===a?o("infinity"):-Infinity===a?o("-infinity"):o("nan"):o(g)+i;break;case "regexp":i=o(g)+i.toString();break;case "date":i=o(g)+ +i;break;case "array":e(a)&&h(c);p.push(a);for(var k=[],i=o(g)+"[",g=0,m=a.length;g<m;g++){k[g.toString()]=!0;var B;B=a.hasOwnProperty(g)?"function"===b.type(a[g])?o(n):d(a[g]).replace(/\\/g,"\\\\").replace(/"/g,'\\"'):o("undefElem");i+='"'+B+'"';g!==a.length-1&&(i+=",")}var g="",q;for(q in a)k[q]||
"function"!==b.type(a[q])&&(g+='"'+q+'":"'+d(a[q]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'",');g&&(i+=(a.length?",":"")+'"'+o("objElem")+"{"+g.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),i=i.replace(/,$/,""),i+='}"');i+="]";f(a);break;case "object":e(a)&&h("循環参照が含まれています。");p.push(a);i=o(g)+"{";for(q in a)a.hasOwnProperty(q)&&"function"!==b.type(a[q])&&(i+='"'+q+'":"'+d(a[q]).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'",');i=i.replace(/,$/,"");i+="}";f(a);break;case "null":case n:i=o(g)}return i}
b.isFunction(g)&&h(11002);var p=[];return"1|"+d(g)},deserialize:function(c){function e(c){function g(b){switch(b){case "s":return"string";case "n":return"number";case "b":return"boolean";case "S":return"String";case "N":return"Number";case "B":return"Boolean";case "i":return"infinity";case "I":return"-infinity";case "x":return"nan";case "d":return"date";case "r":return"regexp";case "a":return"array";case "o":return"object";case "l":return"null";case "u":return n;case "_":return"undefElem";case "@":return"objElem"}}
c.match(/^(.)(.*)/);type=RegExp.$1;f=RegExp.$2?RegExp.$2:"";if(void 0!==type&&""!==type)switch(g(type)){case "String":f=new String(f);break;case "string":break;case "Boolean":"0"===f||"1"===f?f=new Boolean("1"===f):h(m);break;case "boolean":"0"===f||"1"===f?f="1"===f:h(m);break;case "nan":""!==f&&h(m);f=NaN;break;case "infinity":""!==f&&h(m);f=Infinity;break;case "-infinity":""!==f&&h(m);f=-Infinity;break;case "Number":"infinity"===g(f)?f=new Number(Infinity):"-infinity"===g(f)?f=new Number(-Infinity):
"nan"===g(f)?f=new Number(NaN):(f=new Number(f),isNaN(f.valueOf())&&h(m));break;case "number":f=(new Number(f)).valueOf();isNaN(f)&&h(m);break;case "array":var a;try{a=b.parseJSON(f)}catch(i){h(m)}b.isArray(a)||h(m);for(c=0;c<a.length;c++)switch(g(a[c].substring(0,1))){case "undefElem":delete a[c];break;case "objElem":for(var k=e(o("object")+a[c].substring(1)),t=[],c=0,r=a.length-1;c<r;c++)t[c]=a[c];a=t;for(var B in k)a[B]=k[B];break;default:a[c]=e(a[c])}f=a;break;case "object":try{a=b.parseJSON(f)}catch(q){h(m)}b.isPlainObject(a)||
h(m);for(B in a)a[B]=e(a[B]);f=a;break;case "date":f=new Date(parseInt(f,10));break;case "regexp":f.match(/^\/(.*)\/(.*)$/);a=RegExp.$1;B=RegExp.$2;try{f=RegExp(a,B)}catch(C){h(m)}break;case "null":""!==f&&h(m);f=null;break;case n:""!==f&&h(m);f=void 0;break;default:h(l)}return f}"string"!==typeof c&&h(11009);c.match(/^(.)\|(.*)/);c=RegExp.$1;"1"!==c&&h(11003,[c,"1"]);var f=RegExp.$2;return e(f)},isJQueryObject:function(c){return!c||!c.jquery?!1:c.jquery===b().jquery},argsToArray:function(b){return Array.prototype.slice.call(b)},
getByPath:function(b){"string"!==typeof b&&h(11E3,"h5.u.obj.getByPath()");b=b.split(".");"window"===b[0]&&b.unshift();for(var c=window,f=0,d=b.length;f<d&&!(c=c[b[f]],null==c);f++);return c}})})();(function(){var o,n,l,c,m,r,s;function x(b){return b.match(/^error$/i)?o:b.match(/^warn$/i)?n:b.match(/^info$/i)?l:b.match(/^debug$/i)?c:b.match(/^trace$/i)?m:b.match(/^all$/i)?r:b.match(/^none$/i)?s:null}function k(a,c){var d={};if(b.isArray(a)){var g=a.slice(0,3).join(" <- ");0<a.slice(3).length&&(g+=
" ...");d.recent=g;d.all=c.join("\n")}else d.recent=a,d.all=c;return d}function g(b){var a="";b.name?a=b.name:(/^\s*function\s*([\w\-\$]+)?\s*\(/i.test(b.toString()),a=RegExp.$1);return a}function F(a){for(var a=e.u.obj.argsToArray(a),c=[],d=0,g=a.length;d<g;d++)c.push(b.type(a[d]));return c.join(", ")}function f(){}function d(a){("string"!==typeof a||0===b.trim(a).length)&&h(v);this.category=b.trim(a)}var p=10002,a=10003,i=10004,v=10005,t=10007,H=10008,B=10010,q={1E4:'ログターゲットのtypeには、オブジェクト、もしくは"console"のみ指定可能です。',
10001:"outの各要素について、categoryは必須項目です。。"};q[p]='category"{0}"が複数回指定されています。';q[a]='level"{0}"の指定は不正です。Number、もしくはtrace, info, debug, warn, error, noneを指定してください。';q[t]='ログターゲット"{0}"が複数回指定されています。';q[i]='"{0}"という名前のログターゲットはありません。';q[v]="categoryは必須項目です。1文字以上の文字列を指定してください。";q[H]="ログターゲット(targets)の指定は1文字以上の文字列、または配列で指定してください。";q[10009]="ログターゲット(target)の指定はプレーンオブジェクトで指定してください。";q[B]="outの各要素についてcategoryは文字列で指定する必要があります。";N(q);o=50;n=40;l=30;c=20;m=10;r=0;s=-1;var C=null;f.prototype={init:function(){},log:function(b){window.console&&
("string"!==typeof b.args[0]?this._logObj(b):this._logMsg(b))},_logMsg:function(b){var a=b.args,c=null,c=1===a.length?a[0]:e.u.str.format.apply(e.u.str,a),a=this._getLogPrefix(b)+c;b.logger.enableStackTrace&&(a+="  ["+b.stackTrace.recent+"]");b.logger.enableStackTrace&&console.groupCollapsed?console.groupCollapsed(a):this._consoleOut(b.level,a);b.logger.enableStackTrace&&this._consoleOut(b.level,b.stackTrace.all);b.logger.enableStackTrace&&console.groupEnd&&console.groupEnd()},_consoleOut:function(b,
a){var d=!1;b==o&&console.error?(console.error(a),d=!0):b==n&&console.warn?(console.warn(a),d=!0):b==l&&console.info?(console.info(a),d=!0):b==c&&console.debug&&(console.debug(a),d=!0);!d&&console.log&&console.log(a)},_getLogPrefix:function(b){return"["+b.levelString+"]"+b.date.getHours()+":"+b.date.getMinutes()+":"+b.date.getSeconds()+","+b.date.getMilliseconds()+": "},_logObj:function(b){var a=b.args,d=this._getLogPrefix(b);a.unshift(d);b.level==o&&console.error?this._output(console.error,a):b.level==
n&&console.warn?this._output(console.warn,a):b.level==l&&console.info?this._output(console.info,a):b.level==c&&console.debug?this._output(console.debug,a):this._output(console.log,a)},_output:function(b,a){b.apply?b.apply(console,a):b(a)}};d.prototype={enableStackTrace:!1,maxStackSize:10,error:function(b){this._log(o,arguments,this.error)},warn:function(b){this._log(n,arguments,this.warn)},info:function(b){this._log(l,arguments,this.info)},debug:function(b){this._log(c,arguments,this.debug)},trace:function(b){this._log(m,
arguments,this.trace)},_traceFunctionName:function(a){var c=Error(),d=c.stack||c.stacktrace,c={},i=[];if(d)var i=d.replace(/\r\n/,"\n").replace(/at\b|@|Error\b|\t|\[arguments not available\]/ig,"").replace(/(http|https|file):.+[0-9]/g,"").replace(/ +/g," ").split("\n"),f=null,i=b.map(i,function(a){return f=0===a.length?null:""===b.trim(a)?"{anonymous}":b.trim(a)}),c=k(i.slice(3,i.length),i.slice(0,this.maxStackSize));else if(a=a.caller,d=0,a)for(;;){var j=F(a.arguments),e=g(a);e?i.push("{"+e+"}("+
j+")"):a.caller?i.push("{anonymous}("+j+")"):i.push("{root}("+j+")");if(!a.caller||d>=this.maxStackSize){c=k(i,i);break}a=a.caller;d++}else k("{unable to trace}","{unable to trace}");return c},_log:function(b,a,c){var a={level:b,args:e.u.obj.argsToArray(a),stackTrace:this.enableStackTrace?this._traceFunctionName(c):""},d=C.out,i=C.defaultOut,c=null;if(d)for(var d=z(d),j=0,g=d.length;j<g;j++){var f=d[j];if(f.compiledCategory.test(this.category)){c=f;break}}c||(c=i);j=c.compiledLevel;c=c.compiledTargets;
if(!(b<j||0>j))if(a.logger=this,a.date=new Date,a.levelString=this._levelToString(b),c&&0!==c.length){j=0;for(g=c.length;j<g;j++)c[j].log(a)}},_levelToString:function(b){if(b===o)return"ERROR";if(b===n)return"WARN";if(b===l)return"INFO";if(b===c)return"DEBUG";if(b===m)return"TRACE"}};e.u.obj.expose("h5.log",{createLogger:function(b){return new d(b)},configure:function(){function c(j,f,e){var k=null==e;if(!k){var w=f.category;("string"!==typeof w||0===b.trim(w).length)&&h(B);w=b.trim(w);-1!==b.inArray(w,
g)&&h(p,f.category);f.compiledCategory=S(w);g.push(w)}w=null==f.level?x(k?d.level:e.level):"string"===typeof f.level?x(b.trim(f.level)):f.level;"number"!==typeof w&&h(a,f.level);f.compiledLevel=w;var w=[],m=f.targets;if(!k||null!=m){var u=[];null==m||b.isArray(m)||"string"===typeof m&&b.trim(m).length||h(H);for(var m=z(m),o=0,q=m.length;o<q;o++){null==m[o]||"string"===typeof m[o]&&b.trim(m[o]).length||h(H);var v=m[o];if(v){-1!==b.inArray(v,u)&&h(t,v);var n=j[v];n||h(i,v);u.push(v);w.push(n.compiledTarget)}}if(!k&&
(j=e.targets,null!=j)){j=z(j);o=0;for(q=j.length;o<q;o++)v=j[o],-1===b.inArray(v,u)&&(w.push(e.compiledTargets[o]),u.push(v))}}f.compiledTargets=w}var d={level:"NONE",targets:null},g=[];C=b.extend(!0,{},e.settings.log?e.settings.log:{defaultOut:d});var k=C.target;k||(k={},C.target=k);(function(a){b.isPlainObject(a)||h(10009);for(var c in a){var d=a[c];b.type(d.type)!=="object"&&d.type!=="console"&&h(1E4);var j=null,j=d.type==="console"?new f:b.extend(true,{},d.type);j.init&&j.init(d);d.compiledTarget=
j}a.console={type:"console",compiledTarget:new f}})(k);var m=C.defaultOut;m||(m=d,C.defaultOut=m);c(k,m);var j=C.out;if(j)for(var j=z(j),w=0,u=j.length;w<u;w++)c(k,j[w],m)}})})();(function(){function h(c){e.settings.aspects=b.map(z(c),function(b){b.target&&(b.compiledTarget=S(b.target));b.pointCut&&(b.compiledPointCut=S(b.pointCut));return b})}e.u.obj.ns("h5.settings");e.settings={commonFailHandler:null,aspects:null,log:null};var n=e.u.createInterceptor(function(b,e){e.start=new Date;return b.proceed()},
function(b,e){this.log.info('{0} "{1}": {2}ms',this.__name,b.funcName,new Date-e.start)}),l=e.u.createInterceptor(function(b){this.log.info('{0} "{1}"が開始されました。',this.__name,b.funcName);this.log.info(b.args);return b.proceed()},function(b){this.log.info('{0} "{1}"が終了しました。',this.__name,b.funcName)});e.u.obj.expose("h5.core.interceptor",{lapInterceptor:n,logInterceptor:l,errorInterceptor:function(c){var h=null;try{h=c.proceed()}catch(o){e.settings.commonFailHandler&&b.isFunction(e.settings.commonFailHandler)&&
e.settings.commonFailHandler.call(null,o)}return h}});b(window.document).trigger("h5preinit");e.settings.aspects&&h(e.settings.aspects);e.log.configure()})();(function(){e.u.obj.expose("h5.env",{ua:function(e){var h=!!e.match(/iPhone/i),l=!!e.match(/iPad/i),c=h||l,m=!!e.match(/android/i),r=!!e.match(/Windows Phone/i),s=!!e.match(/MSIE/),x=!!e.match(/Firefox/i),k=!!e.match(/Chrome/i)||!!e.match(/CrMo/),g=!m&&!!e.match(/Safari/i)&&!k,F=!!e.match(/Webkit/i),f=!!e.match(/Opera/i),d=m&&!!e.match(/Safari/i)&&
!k,p=!(!h&&!r&&!(d&&e.match(/Mobile/)&&!e.match(/SC-01C/)||m&&k&&e.match(/Mobile/)||e.match(/Fennec/i)||e.match(/Opera Mobi/i))),a=!(!l&&!(d&&!e.match(/Mobile/)||m&&k&&!e.match(/Mobile/)||e.match(/SC-01C/)||e.match(/Fennec/i)||e.match(/Opera Tablet/i))),i=!p&&!a,v=null,t=null,H=function(a,c){return b.trim(e.substring(e.indexOf(a)+a.length,e.indexOf(c))).split("_")},B=function(a,c){var d=b.trim(e.match(!1===c?RegExp(a+"[^;)]*"):RegExp(a+"[^;)]*","i"))).split(" ");return 1===d.length?"":d[d.length-
1]},q=function(a,c){var d=b.trim(e.match(!1===c?RegExp(a+"[^;) ]*"):RegExp(a+"[^;) ]*","i"))).split("/");return 1===d.length?"":d[d.length-1]};if(h)t=H("iPhone OS","like"),v=parseInt(t[0]),t=t.join(".");else if(l)t=H("CPU OS","like"),v=parseInt(t[0]),t=t.join(".");else if(!m||!x)m?(t=B("Android"),v=parseInt(t.split(".")[0])):r&&((t=B("Windows Phone OS"))||(t=B("Windows Phone")),v=parseInt(t.split(".")[0]));s&&f&&(s=!1);var C=H=null;if(c||m&&d)H=v,C=t;else{var D=null;s?D=B("MSIE",!1):k?(D=q("Chrome",
!1))||(D=q("CrMo",!1)):g?D=q("Version"):x?D=q("Firefox"):f&&((D=q("Version"))||(D=q("Opera")),D||(D=B("Opera")));D&&(H=parseInt(D.split(".")[0]),C=D)}return{osVersion:v,osVersionFull:t,browserVersion:H,browserVersionFull:C,isiPhone:h,isiPad:l,isiOS:c,isAndroid:m,isWindowsPhone:r,isIE:s,isFirefox:x,isChrome:k,isSafari:g,isOpera:f,isAndroidDefaultBrowser:d,isSmartPhone:p,isTablet:a,isDesktop:i,isWebkit:F}}(navigator.userAgent)})})();(function(){N({5E3:"h5.async.each() の第1引数は配列のみを扱います。"});var o=b.Deferred,
n=function(){var b=o();if(!b.notify&&!b.notifyWith&&!b.progress){var h=!1,l=null,n=null;b.__h5__progressCallbacks=[];b.__h5__progressFilters=[];var x=function(a){var d=this.__h5__progressPipeFilters;if(h){var e=n;if(d&&0<d.length)for(var g=0,i=d.length;g<i;g++)e=d[g].apply(this,z(e));e!==n&&(e=z(e));a.apply(l,e)}b.__h5__progressCallbacks.push(a);b.__h5__progressFilters.push(d);return this};b.progress=x;var k=b.promise;b.promise=function(b){b=k.call(this,b);b.progress=x;return b};b.notify=function(){h=
!0;-1!==arguments.length&&(l=this,n=e.u.obj.argsToArray(arguments));var a=b.__h5__progressCallbacks,d=b.__h5__progressFilters,g=e.u.obj.argsToArray(arguments);if(0<a.length)for(var i=0,f=a.length;i<f;i++){var k=g;if(d[i]&&0<d[i].length)for(var p=0,t=d[i].length;p<t;p++)k=d[i][p].apply(this,z(k));k!==arguments&&(k=z(k));a[i].apply(this,k)}return this};b.notifyWith=function(b,a){h=!0;l=b;n=a;var d=this.__h5__progressCallbacks,c=this.__h5__progressFilters;if(0<d.length)for(var e=0,i=d.length;e<i;e++){var g=
a;if(c[e]&&0<c[e].length)for(var f=0,j=c[e].length;f<j;f++)g=c[e][f].apply(this,z(g));g!==a&&(g=z(g));d[e].apply(b,g)}return this};var g=b.pipe;b.pipe=function(a,d,e){a=g.call(this,a,d);e&&(a.__h5__progressPipeFilters=this.__h5__progressPipeFilters?this.__h5__progressPipeFilters.concat([e]):[e]);a.pipe=b.pipe;a.progress=b.progress;return a}}var F=!1,f=b.fail,d=function(){0<arguments.length&&(F=!0);return f.apply(this,arguments)};b.fail=d;var p=b.always,a=function(){0<arguments.length&&(F=!0);return p.apply(this,
arguments)};b.always=a;var i=function(b,a,d){b&&this.done.apply(this,z(b));a&&this.fail.apply(this,z(a));d&&this.progress.apply(this,z(d));return this};b.then=i;var v=b.reject;b.reject=function(){var b=e.settings.commonFailHandler;!F&&b&&f.call(this,b);return v.apply(this,arguments)};var t=b.rejectWith;b.rejectWith=function(){var b=e.settings.commonFailHandler;!F&&b&&this.fail(b);return t.apply(this,arguments)};var H=b.promise;b.promise=function(b){b=H.call(this,b);b.always=a;b.then=i;b.fail=d;return b};
return b},l=function(b){return!!b&&b.done&&b.fail&&!b.resolve&&!b.reject};e.u.obj.expose("h5.async",{deferred:n,when:function(){var c=e.async.deferred();b.when.apply(b,arguments).done(function(){c.resolve.apply(c,arguments)}).fail(function(){c.reject.apply(c,arguments)});return c.promise()},isPromise:l,loop:function(c,e,o){b.isArray(c)||h(5E3);var s=n(),x="number"===b.type(o)?o:20,k=!1,g=0,F=c.length,f,d=null,p=function(){if(g===F)s.resolve(c);else if(k)s.reject(c);else{var b=e.call(c,g,c[g],d);g++;
l(b)?b.done(function(){f()}).fail(function(){k=!0;f()}):f()}},a=function(){setTimeout(function(){var b=g-1;0<g&&s.notify({data:c,index:b,value:c[b]});p()},0)},i=!1;f=function(){i||(0===g%x?a():p())};var v=!1,d={resume:function(){!v&&i&&(i=!1,f())},pause:function(){i=!0},stop:function(){v=!0;s.resolve(c)}};a();return s.promise()}})})();(function(){e.u.obj.expose("h5",{ajax:function(h){var n="string"===typeof arguments[0]?arguments[1]:arguments[0],n=n&&(n.error||n.fail||n.complete||n.always),l=b.ajax.apply(b,
arguments);l.progress||(l.progress=function(){});var c=!1,m=e.settings.commonFailHandler;if(!n&&m){l.fail(function(){c||m.apply(null,arguments)});var r=l.fail;l.fail=function(){c=true;return r.apply(l,arguments)};l.error=l.fail;var s=l.always;l.always=function(){c=true;return s.apply(l,arguments)};l.complete=l.always;l.then=function(b,c,e){b&&l.done.apply(l,z(b));c&&l.fail.apply(l,z(c));e&&l.progress.apply(l,z(e));return l}}return l}})})();(function(){function o(b){return!this.__controllerContext.executeListeners?
void 0:b.proceed()}function n(b,a,d){var e=l(b.__name,a);d&&e.push(o);return c(b[a],a,e)}function l(a,d){var c=[],j=e.settings.aspects;if(!j||0===j.length)return c;for(var j=z(j),i=j.length-1;-1<i;i--){var g=j[i];if(!g.target||g.compiledTarget.test(a)){var f=g.interceptors;if(!g.pointCut||g.compiledPointCut.test(d))if(b.isArray(f))for(g=f.length-1;-1<g;g--)c=c.concat(f[g]);else c.push(f)}}return c}function c(b,a,d){for(var c=function(b,a,y){return function(){var d=this;return y.call(d,{target:d,func:b,
funcName:a,args:arguments,proceed:function(){return b.apply(d,this.args)}})}},j=0,e=d.length;j<e;j++)b=c(b,a,d[j]);return b}function m(b){return!!b.match(/^\{.*\}$/)}function r(b){return!!b.match(/^\[.*\]$/)}function s(a){return b.trim(a.substring(1,a.length-1))}function x(a){return b.trim(a.substring(1,a.length-1))}function k(b){return X(b,"window")||X(b,"document")||X(b,"navigator")?Z(b):b}function g(a){var d=function(a,y){for(var c in a)if(0<=b.inArray(a,y)||U(c,aa)&&d(a[c],y.concat([a])))return!0;
return!1};return d(a,[])}function F(a){var d=function(a,y){for(var c in a)if(0<=b.inArray(a,y)||U(c,ba)&&d(a[c],y.concat([a])))return!0;return!1};return d(a,[])}function f(a,d){var c=a[d];return U(d,aa)&&"rootController"!==d&&"parentController"!==d&&!b.isFunction(c)&&c&&!c.__controllerContext.isRoot}function d(a,d,c){var j=[],e=[],g=function(a){e.push(a);for(var y in a)if(f(a,y)){var i=a[y],k=c?i.__controllerContext[d]:i[d];k&&j.push(k);-1===b.inArray(i,e)&&g(i)}};g(a);return j}function p(b){var d=
function(b){var y=b.__meta,c={};if(y)for(var j in y)!1===y[j].useHandlers&&(c[j]=1);for(j in b)y=b[j],f(b,j)&&(d(y),c[j]||a(y))};d(b)}function a(a){var d=a.__controllerContext.bindMap,c;for(c in d)for(var e in d[c]){var g=a,f=c,k=e,w=g.__controllerContext.bindMap[f][k],p=k,h=r(k);h&&(p=x(k));var t=null;switch(p){case "mousewheel":t=G(g,f,p,w);break;case $:case W:case ca:t=j(g,f,k,w);break;default:t=E(g,f,p,w)}if(b.isArray(t)){g=0;for(f=t.length;g<f;g++)i(t[g],h)}else i(t,h)}}function i(a,d){d&&(a.eventName=
"["+a.eventName+"]");var c=a.controller,j=a.selector,e=a.eventName,g=a.handler;c.__controllerContext.unbindMap[j]||(c.__controllerContext.unbindMap[j]={});c.__controllerContext.unbindMap[j][e]=g;var c=a.controller.rootElement,i=a.selector,g=a.eventName,j=a.handler,g=(e=r(g))?x(g):g;if(m(i)){var i=s(i),f=!1;i===pa?(i=c,f=!0):i=k(i);f||e||i===document||i===window?b(i).bind(g,j):b(i).live(g,j)}else e?b(i,c).bind(g,j):b(c).delegate(i,g,j)}function v(b){var a=function(b){var d=b.__meta,y={};if(d)for(var c in d)!1===
d[c].useHandlers&&(y[c]=1);for(c in b)d=b[c],f(b,c)&&(a(d),y[c]||t(d))};a(b)}function t(a){var d=a.rootElement,a=a.__controllerContext.unbindMap,c;for(c in a)for(var j in a[c]){var e=a[c][j],g=r(j),i=g?x(j):j;if(m(c)){var f=s(c),w=!1;f===pa?(f=d,w=!0):f=k(f);var p=f===document||f===window;w||g||p?b(f).unbind(i,e):b(f).die(i,e)}else g?b(c,d).unbind(i,e):b(d).undelegate(c,i,e)}}function H(a,d){a.__controllerContext.executeListeners=d;var c=[],j=function(a){c.push(a);for(var y in a)if(f(a,y)){var e=
a[y];e.__controllerContext.executeListeners=d;-1===b.inArray(e,c)&&j(e)}};j(a)}function B(a){var d=[],c=function(a,y,j){a.rootController=y;a.parentController=j;d.push(a);for(var e in a)f(a,e)&&(j=a[e],-1===b.inArray(j,d)&&c(j,y,a))};c(a,a,null)}function q(a,c){var j=c?"__init":"__ready",g=J();setTimeout(function(){g.resolve()},0);var i=g.promise(),k=function(a){var y=!0,g;for(g in a)f(a,g)&&(y=!1,k(a[g]));var w=function(){var b=null;a[j]&&(b=a[j]({args:a.__controllerContext.args}));var d=c?D(a):Ja(a);
e.async.isPromise(b)?b.done(function(){d()}):d()};g=c?C(a):d(a,"readyPromise");c&&y&&g.push(i);e.async.when.apply(b,g).done(function(){w()}).fail(function(b){e.settings.commonFailHandler&&e.settings.commonFailHandler(b)})};k(a)}function C(b){var a=d(b,"initPromise");a.push(b.preinitPromise);return a}function D(b){return function(){if(b.__controllerContext&&!b.__controllerContext.isDisposing){b.isInit=!0;var a=b.__controllerContext.initDfd;delete b.__controllerContext.templatePromise;delete b.__controllerContext.initDfd;
a.resolve();b.__controllerContext&&b.__controllerContext.isRoot&&Ka(b)}}}function Ja(a){return function(){if(a.__controllerContext&&!a.__controllerContext.isDisposing){a.isReady=!0;var d=a.__controllerContext.readyDfd;delete a.__controllerContext.readyDfd;d.resolve();a.__controllerContext&&a.__controllerContext.isRoot&&a.rootElement&&a.isInit&&a.isReady&&b(a.rootElement).trigger("h5controllerready",[a])}}}function I(a,d,c){if("string"!==typeof a)return b(a);var j=b.trim(a);m(j)?(a=s(j),c&&(X(a,"window")||
X(a,"navigator"))&&h(qa),c=b(k(a))):c=b(d).find(a);return c}function E(b,a,d,c){return{controller:b,selector:a,eventName:d,handler:function(){c.call(b,u(b,arguments))}}}function G(b,a,d,c){return{controller:b,selector:a,eventName:typeof document.onmousewheel===S?"DOMMouseScroll":d,handler:function(){var a=u(b,arguments),d=a.event;d.originalEvent&&d.originalEvent.detail&&(d.wheelDelta=40*-d.detail);c.call(b,a)}}}function j(a,d,c,j){var e=typeof document.ontouchstart!==S;if(c!==$)return e?E(a,d,c,j):
E(a,d,c,function(a){var d=a.event,c=b(d.currentTarget).offset()||{left:0,top:0};d.offsetX=d.pageX-c.left;d.offsetY=d.pageY-c.top;j.apply(this,arguments)});var g=function(b,a){for(var d in b)b.hasOwnProperty(d)&&!a[d]&&"target"!==d&&"currentTarget"!==d&&"originalEvent"!==d&&"liveFired"!==d&&(a[d]=b[d]);a.h5DelegatingEvent=b},i=e?"touchstart":"mousedown",f=e?"touchmove":"mousemove",k=e?"touchend":"mouseup",p=b(document);return function(){var h=null,t=!1,v=function(d,c,j){return function(i){var Q;a:{switch(d){case "touchstart":case "mousedown":Q=
$;break a;case "touchmove":case "mousemove":Q=W;break a;case "touchend":case "mouseup":Q=ca;break a}Q=void 0}var R=Q===$;if(!R||!t){var m=u(a,arguments),l=m.event;e&&w(l,d);var n=new b.Event(Q);g(l,n);l=l.target;c&&(l=c);j&&j(n);if(!e||t||R)b(l).trigger(n,m.evArg),t=!0;if(R&&t){n.h5DelegatingEvent.preventDefault();var R=n.target,o=n.clientX,q=n.clientY,O=v(f,R,function(b){var a=b.clientX,d=b.clientY;b.dx=a-o;b.dy=d-q;o=a;q=d}),oa=v(k,R),P=e?b(R):p;h=function(){P.unbind(f,O);P.unbind(k,oa)};P.bind(f,
O);P.bind(k,oa)}Q===ca&&(h(),t=!1)}}},m=[E(a,d,c,j)];m.push({controller:a,selector:d,eventName:i,handler:v(i)});return m}()}function w(a,d){var c=a.originalEvent,j="touchend"===d||"touchcancel"===d?c.changedTouches[0]:c.touches[0],e=j.pageX,g=j.pageY;a.pageX=c.pageX=e;a.pageY=c.pageY=g;a.screenX=c.screenX=j.screenX;a.screenY=c.screenY=j.screenY;a.clientX=c.clientX=j.clientX;a.clientY=c.clientY=j.clientY;j=a.target;if(j.ownerSVGElement)j=j.farthestViewportElement;else if(j===window||j===document)j=
document.body;if(j=b(j).offset())g-=j.top,a.offsetX=c.offsetX=e-j.left,a.offsetY=c.offsetY=g}function u(a,d){var c=null,j=null;d&&(c=d[0],j=d[1]);var e=c;if(e&&null==e.offsetX&&null==e.offsetY&&e.pageX&&e.pageY){var g=e.target;if(g.ownerSVGElement)g=g.farthestViewportElement;else if(g===window||g===document)g=document.body;if(g=b(g).offset())e.offsetX=e.pageX-g.left,e.offsetY=e.pageY-g.top}return{controller:a,rootElement:a.rootElement,event:c,evArg:j}}function O(b){for(var a in b){var d=b[a];f(b,
a)&&(d.rootElement=null,d.view.__controller=null,O(d))}}function P(b){var a=b.rootElement,d=b.__meta,c;for(c in b){var j=b[c];f(b,c)&&(j.rootElement=d&&d[c]&&d[c].rootElement?ia(d[c].rootElement,a,j):a,j.view.__controller=j,P(j))}}function ia(a,d,c){a?(!c||!c.__controllerContext)&&h(ra):h(sa);a=d?I(a,d):b(a);0===a.length&&h(da,[c.__name]);1<a.length&&h(ea,[c.__name]);return a.get(0)}function Ka(c){a(c);p(c);var j=e.core.controllerManager.controllers;-1===b.inArray(c,j)&&j.push(c);b(c.rootElement).trigger("h5controllerbound",
[c]);j=d(c,"initPromise");j.push(c.initPromise);e.async.when.apply(b,j).done(function(){q(c,!1)})}function ja(b){null===b.rootController&&B(b);P(b);q(b,!0)}function ka(b,a){var d=J();d.resolve();b.__controllerContext.templatePromise=d.promise();b.__controllerContext.initDfd=J();b.initPromise=b.__controllerContext.initDfd.promise();b.__controllerContext.readyDfd=J();b.readyPromise=b.__controllerContext.readyDfd.promise();b.isInit=!1;b.isReady=!1;b.__controllerContext.args=a;for(var c in b)f(b,c)&&
ka(b[c])}function la(a,d){var c=null,j=d;b.isPlainObject(j)?c=j.target:j={};c=c?I(c,a.rootElement,!0):a.rootElement;return e.ui.indicator.call(a,c,j)}function ma(a,d){var c=[],j=[],e=function(a){j.push(a);for(var g in a)if(f(a,g)){var i=a[g];-1===b.inArray(i,j)&&e(i)}a[d]&&b.isFunction(a[d])&&c.push(a[d]())};e(a);return c}function La(a){var d=[],c=function(a){d.push(a);Z("h5.core.view")&&a.view.clear();for(var j in a){if(f(a,j)){var e=a[j];-1===b.inArray(e,d)&&c(e)}a[j]=null}};c(a)}function T(b,a){return a.view.__view.isAvailable(b)?
a.view.__view:a.parentController?T(b,a.parentController):e.core.view}function na(b){this.__controller=b;Z("h5.core.view")&&(this.__view=e.core.view.createView())}function Y(a,d,c,j){this.__name=d;this.__templates=null;this.rootElement=a;this.__controllerContext={executeListeners:!0,isRoot:j,bindMap:{},unbindMap:{}};c&&(this.__controllerContext.args=b.extend(!0,{},c));this.isReady=this.isInit=!1;this.readyPromise=this.initPromise=this.parentController=this.rootController=null;this.log=e.log.createLogger(d);
this.view=new na(this)}function K(){this.rootElement=document;this.controllers=[];b(document).bind("triggerIndicator",function(b,a){null==a.target&&(a.target=document);a.indicator=la(this,a);b.stopPropagation()})}function ta(a,d,c,j){var e=d.__name;(!e||0===b.trim(e).length)&&h(ua,null,{controllerDefObj:d});c&&!b.isPlainObject(c)&&h(va,[e],{controllerDefObj:d});d.__controllerContext&&h(wa,null,{controllerDefObj:d});if(a){var i=b(a);0===i.length&&h(da,[e],{controllerDefObj:d});1<i.length&&h(ea,[e],
{controllerDefObj:d})}g(d)&&h(xa,[e],{controllerDefObj:d});F(d)&&h(ya,[e],{controllerDefObj:d});var f=!j||!j.isInternal,i=b.extend(!0,{},d),k=new Y(a?b(a).get(0):null,e,c,f),w=d.__templates,p=J(),a=p.promise(),t=J(),f=t.promise();k.__controllerContext.templatePromise=a;k.preinitPromise=f;k.__controllerContext.initDfd=J();k.initPromise=k.__controllerContext.initDfd.promise();k.__controllerContext.readyDfd=J();k.readyPromise=k.__controllerContext.readyDfd.promise();if(w&&0<w.length){var v=function(a){Z("h5.core.view")||
h(za);k.view.load(w).then(function(){p.resolve()},function(b){var c=b.detail.error.status;a===L||0!==c&&12029!==c?(b.controllerDefObject=d,setTimeout(function(){p.reject(b)},0)):setTimeout(function(){v(++a)},V)})};v(0)}else p.resolve();a.done(function(){t.resolve()}).fail(function(a){t.reject(a);k.__controllerContext&&k.rootController.dispose()});for(var u in i)if(fa[u])h(Aa,[e,u],{controllerDefObj:d});else if(("__ready"===u||"__construct"===u||"__init"===u)&&b.isFunction(i[u]))k[u]=n(i,u);else if(-1!==
u.indexOf(" ")&&b.isFunction(i[u])){f=b.trim(u).lastIndexOf(" ");a=b.trim(u.substring(0,f));f=b.trim(u.substring(f+1,u.length));r(f)&&(f="["+b.trim(x(f))+"]");m(a)&&"this"===s(a)&&h(Ba,[e],{controllerDefObj:d});var l=k.__controllerContext.bindMap;l[a]||(l[a]={});l[a][f]&&h(Ca,[e,a,f],{controllerDefObj:d});var o=n(i,u,!0);l[a][f]=o;k[u]=o}else U(u,aa)&&i[u]&&!b.isFunction(i[u])?(a=ta(null,b.extend(!0,{},i[u]),c,b.extend({isInternal:!0},j)),k[u]=a):U(u,ba)&&i[u]&&!b.isFunction(i[u])?(a=ga(i[u]),k[u]=
a):k[u]=b.isFunction(i[u])?n(i,u):i[u];if(c=k.__meta)for(u in c)a=k[u],void 0===a&&h(Da,[e,u],{controllerDefObj:d}),null===a&&h(Ea,[e,u],{controllerDefObj:d}),Y.prototype.constructor!==a.constructor&&h(Fa,[e,u],{controllerDefObj:d});k.__construct&&k.__construct({args:k.__controllerContext.args});if(!k.__controllerContext||k.__controllerContext.isDisposing)return null;k.__controllerContext.isRoot&&ja(k);return k}function ga(a){var d=a.__name;(!d||0===b.trim(d.length))&&h(Ga,null,{logicDefObj:a});a.__logicContext&&
h(Ha,null,{logicDefObj:a});var a=b.extend(!0,{},a),j;for(j in a)a[j]=b.isFunction(a[j])?c(a[j],j,l(a.__name,j)):a[j];a.deferred=J;a.log=e.log.createLogger(d);a.__logicContext={};for(var g in a)a.hasOwnProperty(g)&&U(g,ba)&&(a[g]=ga(a[g]));return a}var L=3,V=3E3,S="undefined",aa="Controller",ba="Logic",$="h5trackstart",W="h5trackmove",ca="h5trackend",pa="rootElement",qa=6E3,sa=6001,ra=6002,da=6003,ea=6004,ua=6006,va=6007,wa=6008,xa=6009,ya=6010,Aa=6011,Ba=6012,Ca=6013,Da=6014,Ea=6015,Fa=6016,Ga=6017,
Ha=6018,za=6029,A={};A[qa]='update/append/prepend() の第1引数に"window", "navigator", または"window.", "navigator."で始まるセレクタは指定できません。';A[sa]="バインド対象となる要素を指定して下さい。";A[ra]="コントローラ化したオブジェクトを指定して下さい。";A[da]='コントローラ"{0}"のバインド対象となる要素が存在しません。';A[ea]='コントローラ"{0}"のバインド対象となる要素が2つ以上存在します。バインド対象は1つのみにしてください。';A[6005]="エラータイプを指定してください。";A[ua]="コントローラの名前が定義されていません。__nameにコントローラ名を設定して下さい。";A[va]='コントローラ"{0}"の初期化パラメータがプレーンオブジェクトではありません。初期化パラメータにはプレーンオブジェクトを設定してください。';A[wa]="指定されたオブジェクトは既にコントローラ化されています。";A[xa]='コントローラ"{0}"で、参照が循環しているため、コントローラを生成できません。';
A[ya]='コントローラ"{0}"のロジックで、参照が循環しているため、ロジックを生成できません。';A[Aa]='コントローラ"{0}"のプロパティ"{1}"はコントローラ化によって追加されるプロパティと名前が重複しています。';A[Ba]='コントローラ"{0}"でセレクタ名にthisが指定されています。コントローラをバインドした要素自身を指定したい時はrootElementを指定してください。';A[Ca]='コントローラ"{0}"のセレクタ"{1}"に対して"{2}"というイベントハンドラが重複して設定されています。';A[Da]='コントローラ"{0}"には__metaで指定されたプロパティ"{1}"がありません。';A[Ea]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値がnullです。コントローラを持つプロパティキー名を指定してください。';A[Fa]='コントローラ"{0}"の__metaに指定されたキー"{1}"の値はコントローラではありません。コントローラを持つプロパティキー名を指定してください。';A[Ga]="ロジック名が定義されていません。__nameにロジック名を設定して下さい。";
A[Ha]="指定されたオブジェクトは既にロジック化されています。";A[6019]="コントローラ、もしくはロジックの __name が設定されていません。";A[za]="テンプレートはViewモジュールがなければ使用できません。";N(A);e.log.createLogger("h5.core");var J=e.async.deferred,X=e.u.str.startsWith,U=e.u.str.endsWith,Ia=e.u.str.format,ha=e.u.obj.argsToArray,Z=e.u.obj.getByPath;b.extend(na.prototype,{get:function(a,b){return T(a,this.__controller).get(a,b)},update:function(a,b,d){a=I(a,this.__controller.rootElement,!0);T(b,this.__controller).update(a,b,d)},append:function(a,b,d){a=I(a,this.__controller.rootElement,
!0);T(b,this.__controller).append(a,b,d)},prepend:function(a,b,d){a=I(a,this.__controller.rootElement,!0);T(b,this.__controller).prepend(a,b,d)},load:function(a){return this.__view.load(a)},register:function(a,b){this.__view.register(a,b)},isValid:function(a){return this.__view.isValid(a)},isAvailable:function(a){return T(a,this.__controller).isAvailable(a)},clear:function(a){this.__view.clear(a)}});b.extend(Y.prototype,{$find:function(a){return b(this.rootElement).find(a)},deferred:function(){return J()},
trigger:function(a,d){b(this.rootElement).trigger(a,[d])},own:function(a){var b=this;return function(){a.apply(b,arguments)}},ownWithOrg:function(a){var b=this;return function(){var d=e.u.obj.argsToArray(arguments);d.unshift(this);a.apply(b,d)}},bind:function(a,d){this.rootElement=ia(a,null,this);this.view.__controller=this;var c=null;d&&(c=b.extend(!0,{},d));ka(this,c);ja(this);return this},unbind:function(){ma(this,"__unbind");t(this);v(this);this.__controllerContext.unbindMap={};var a=this.rootElement;
e.core.controllerManager.controllers=b.grep(e.core.controllerManager.controllers,function(b){return b.rootElement!==a});b(this.rootElement).trigger("h5controllerunbound");this.rootElement=null;this.view.__controller=null;O(this)},dispose:function(){if(this.__controllerContext&&!this.__controllerContext.isDisposing){this.__controllerContext.isDisposing=1;var a=this.deferred();this.unbind();var d=this,c=ma(this,"__dispose");e.async.when.apply(b,c).done(function(){La(d);a.resolve()});return a.promise()}},
triggerIndicator:function(a,d){var c=b.extend(!0,{},a),j=d;if(!j||0===j.length)j="triggerIndicator";b(this.rootElement).trigger(j,[c]);return c.indicator},indicator:function(a){return la(this,a)},enableListeners:function(){H(this,!0)},disableListeners:function(){H(this,!1)},throwError:function(a,b){var d=null,d=a&&"string"===typeof a?Error(Ia.apply(null,ha(arguments))):Error.apply(null,arguments);d.customType=null;throw d;},throwCustomError:function(a,b,d){null==a&&h(6005);var c=ha(arguments);c.shift();
error=b&&"string"===typeof b?Error(Ia.apply(null,ha(c))):Error.apply(null,c);error.customType=a;throw error;}});b.extend(K.prototype,{getAllControllers:function(){return this.controllers},getController:function(a){for(var a=b(a).get(0),d=this.controllers,c=0,j=d.length;c<j;c++)if(a===d[c].rootElement)return d[c]}});e.u.obj.expose("h5.core",{controllerManager:new K});var fa={},A=new Y(null,"a"),M;for(M in A)A.hasOwnProperty(M)&&"__name"!==M&&"__templates"!==M&&"__meta"!==M&&(fa[M]=1);A=Y.prototype;
for(M in A)A.hasOwnProperty(M)&&(fa[M]=1);e.u.obj.expose("h5.core",{controller:ta,logic:ga,expose:function(a){var b=a.__name;b||h(6019,null,{target:a});var d=b.lastIndexOf(".");if(-1===d)window[b]=a;else{var c=b.substr(0,d),b=b.substr(d+1,b.length),d={};d[b]=a;e.u.obj.expose(c,d)}}})})();(function(){function o(a){return e.u.obj.isJQueryObject(a)?a:b(a)}function n(){this.__cachedTemplates={}}var l=7E3,c=7001,m=7002,r=7003,s={};s[l]="テンプレートをコンパイルできませんでした。{0}";s[c]="テンプレートファイルが不正です。{0}";s[m]="テンプレートIDが指定されていません。空や空白でない文字列で指定してください。";
s[r]="テンプレートファイルを取得できませんでした。ステータスコード:{0} URL:{1}";s[7004]="テンプレートファイルの指定が不正です。空や空白でない文字列、または文字列の配列で指定してください。";s[7005]="テンプレートID:{0} テンプレートがありません。";s[7006]="{0} テンプレートにパラメータが設定されていません。";N(s);var x="scriptタグが見つかりません。テンプレート文字列はscriptタグで囲って記述して下さい。",k="構文エラー {0}{1}",g="[";e.log.createLogger("h5.core.view");var F=e.async.deferred,f={escapeHtml:function(a){return e.u.str.escapeHtml(a)}},d={MAX_CACHE:10,cache:{},cacheUrls:[],accessingUrls:[],append:function(a,b,d){this.cacheUrls.length>=this.MAX_CACHE&&
this.deleteCache(this.cacheUrls[0]);this.cache[a]={};this.cache[a].templates=b;this.cache[a].path=d;this.cacheUrls.push(a)},deleteCache:function(a,b){b||delete this.cache[a];for(var d=0,c=this.cacheUrls.length;d<c;d++)if(this.cacheUrls[d]===a){this.cacheUrls.splice(d,1);break}},getTemplateByUrls:function(a){function d(a){if(0!==a.length){var c={},i=[];a.each(function(){var a=b.trim(this.id),d=b.trim(this.innerHTML);a||h(m,null,{});try{var j=new EJS.Compiler(d,g);j.compile();c[a]=j.process;i.push(a)}catch(f){d=
f.lineNumber,h(l,[e.u.str.format(k,d?" line:"+d:"",f.message)],{id:a,error:f})}});return{compiled:c,data:{ids:i}}}}function f(a,g){var k=g||0;if(a.length==k)E.resolve();else{var h=a[k],l=L(h);q.accessingUrls[l]||(q.accessingUrls[l]=e.ajax(h));q.accessingUrls[l].then(function(e,g,w){delete q.accessingUrls[l];e=b(w.responseText).filter(function(){return this.tagName&&-1===this.tagName.indexOf("/")&&8!==this.nodeType});g=this.url;0<e.not('script[type="text/ejs"]').length&&E.reject(K(c,[x],{url:l,path:g}));
w=null;try{w=d(e.filter('script[type="text/ejs"]'))}catch(h){h.detail.url=l,h.detail.path=g,E.reject(h)}try{var m=w.compiled,n=w.data;n.path=g;n.absoluteUrl=l;b.extend(p,m);o.push(n);q.append(l,m,g);f(a,++k)}catch(O){E.reject(K(c,null,{error:O,url:l,path:g}))}}).fail(function(a){delete q.accessingUrls[l];E.reject(K(r,[a.status,l],{url:l,path:h,error:a}))});return E.promise()}}for(var p={},n=[],o=[],q=this,s=function(a){var b=q.cache[a].templates;q.deleteCache(a,!0);q.cacheUrls.push(a);return b},D=
0;D<a.length;D++){var z=a[D],I=L(z);this.cache[I]?(b.extend(p,s(I)),o.push({absoluteUrl:I})):n.push(z)}var E=F(),G=F();e.async.when(f(n)).done(function(){G.resolve(p,o)}).fail(function(a){G.reject(a)});return G.promise()}};b.extend(n.prototype,{load:function(a){var c=F(),e=this,g=null;switch(b.type(a)){case "string":b.trim(a)||h(7004);g=[a];break;case "array":g=a;0===g.length&&h(7004);for(var a=0,f=g.length;a<f;a++)"string"!==typeof g[a]?h(7004):b.trim(g[a])||h(7004);break;default:h(7004)}d.getTemplateByUrls(g).done(function(a,
d){b.extend(e.__cachedTemplates,a);c.resolve(d)}).fail(function(a){c.reject(a)});return c.promise()},getAvailableTemplates:function(){var a=[],b;for(b in this.__cachedTemplates)a.push(b);return a},register:function(a,d){"string"!==b.type(d)?h(l,["テンプレートには文字列を指定してください"],{id:a}):("string"!==typeof a||!b.trim(a))&&h(m,[]);try{var c=new EJS.Compiler(d,g);c.compile();this.__cachedTemplates[a]=c.process}catch(f){c=f.lineNumber,h(l,[e.u.str.format(k,c?" line:"+c:"",f.message)],{id:a})}},isValid:function(a){try{return(new EJS.Compiler(a,
g)).compile(),!0}catch(b){return!1}},get:function(a,d){var c=this.__cachedTemplates;if(b.isEmptyObject(c))return null;("string"!==typeof a||!b.trim(a))&&h(m);(c=c[a])||h(7005,a);var e=d?b.extend(!0,{},d):{},g=e.hasOwnProperty("_h")?new EJS.Helpers(e):new EJS.Helpers(e,{_h:f}),k=null;try{k=c.call(e,e,g)}catch(p){h(7006,p.toString(),p)}return k},update:function(a,b,d){return o(a).html(this.get(b,d))},append:function(a,b,d){return o(a).append(this.get(b,d))},prepend:function(a,b,d){return o(a).prepend(this.get(b,
d))},isAvailable:function(a){return!!this.__cachedTemplates[a]},clear:function(a){if(void 0===a)this.__cachedTemplates={};else{var d=null;switch(b.type(a)){case "string":d=[a];break;case "array":a.length||h(m);d=a;break;default:h(m)}for(var a=0,c=d.length;a<c;a++){var e=d[a];("string"!==typeof e||!b.trim(e))&&h(m)}a=0;for(c=d.length;a<c;a++)delete this.__cachedTemplates[d[a]]}}});var p=new n;p.createView=function(){return new n};b(function(){b('script[type="text/ejs"]').each(function(){var a=b.trim(this.id),
d=b.trim(this.innerHTML);0!==d.length&&a&&(d=new EJS.Compiler(d,g),d.compile(),p.__cachedTemplates[a]=d.process)})});e.u.obj.expose("h5.core",{view:p})})();(function(){function h(d){var c={},a;for(a in k){var e=b("<div></div>").addClass(d).addClass(a).appendTo("body"),g=b.camelCase(a);c[g]={};b.map(k[a],function(a){c[g][a]="width"===a||"height"===a?parseInt(e.css(a).replace(/\D/g,""),10):e.css(a)});e.remove()}return c}function n(b,c){var a=window.document.createElement("v:"+b),e;for(e in c)a.style[e]=
c[e];return a}function l(b,c){for(var a=[],e=b/2,g=0.8*b/2,f=360/c*Math.PI/180,k=1;k<=c;k++){var h=f*k,l=Math.cos(h),h=Math.sin(h);a.push({from:{x:e+g/2*l,y:e+g/2*h},to:{x:e+g*l,y:e+g*h}})}return a}function c(d){this.style=b.extend(!0,{},d);d=this.style.throbber.width;this.group=n("group",{width:d+"px",height:this.style.throbber.height+"px"});this.group.className=r;for(var d=l(d,this.style.throbber.lines),c=this.style.throbberLine.color,a=this.style.throbberLine.width,e=0,g=d.length;e<g;e++){var f=
d[e],k=f.from,h=f.to,f=n("line");f.strokeweight=a;f.strokecolor=c;f.fillcolor=c;f.from=k.x+","+k.y;f.to=h.x+","+h.y;k=n("stroke");k.opacity=1;f.appendChild(k);this.group.appendChild(f)}this._createPercentArea()}function m(d,k){b.blockUI.defaults.css={};b.blockUI.defaults.overlayCSS={};this.target=e.u.obj.isJQueryObject(d)?d.get(0):d;var a=this,i=this._isGlobalBlockTarget()?b("body"):b(this.target),l=i.css("position"),m=i.css("zoom"),n=b.extend(!0,{},{message:"",percent:-1,block:!0,promises:null,theme:"a"},
k),r={message:e.u.str.format(s,""===n.message?'style="display: none;"':"",n.message),css:{},overlayCSS:{},blockMsgClass:n.theme,showOverlay:n.block,centerX:!1,centerY:!1,onUnblock:function(){i.css("position",l);i.css("zoom",m);a.throbber.hide()}},q={throbber:{roundTime:1E3,lines:12},throbberLine:{},percent:{}},C=n.promises,D=b.proxy(function(){this.hide()},this);b.isArray(C)?(b.map(C,function(a){return x(a)?a:null}),0<C.length&&e.async.when.apply(null,C).pipe(D,D)):x(C)&&C.pipe(D,D);C=h(n.theme);
q=b.extend(!0,q,C);this._style=b.extend(!0,{},r,q);g?this.throbber=new f(this._style):F&&(this.throbber=new c(this._style));this.throbber&&-1<n.percent&&this.throbber.setPercent(n.percent)}var r="vml-root",s='<span class="indicator-throbber"></span><span class="indicator-message" {0}>{1}</span>',x=e.async.isPromise,k={throbber:["width","height"],"throbber-line":["width","color"]},g=!0,F=e.env.ua.isIE;b(function(){g=!!document.createElement("canvas").getContext;!g&&F&&(document.namespaces.add("v",
"urn:schemas-microsoft-com:vml"),document.createStyleSheet().cssText="v\\:stroke,v\\:line,v\\:textbox{behavior: url(#default#VML);}")});c.prototype={show:function(b){b&&(this.root=b,this.highlightPos=1,this.hide(),this.root.appendChild(this.group),this._run())},hide:function(){this.root.innerHTML="";this._runId&&(clearTimeout(this._runId),this._runId=null)},_run:function(){for(var b=this.style.throbber.lines,c=this.style.throbber.roundTime,a=this.highlightPos,e=this.group.childNodes,g=0,f=e.length;g<
f;g++){var k=e[g];if("textbox"!==k.nodeName){var h=g+1;k.firstChild.opacity=h==a?"1":h==a+1||h==a-1?"0.75":"0.4"}}a==b?a=0:a++;this.highlightPos=a;var l=this;this._runId=setTimeout(function(){l._run.call(l)},Math.floor(c/b))},_createPercentArea:function(){var d=n("textbox"),c=b("<table><tr><td></td></tr></table>"),a=c.find("td");a.width(this.group.style.width);a.height(this.group.style.height);a.css("line-height",this.group.style.height);a.addClass("throbber-percent");d.appendChild(c[0]);this.group.appendChild(d)},
setPercent:function(d){b(this.group).find(".throbber-percent").html(d)}};var f=function(d){this.style=b.extend(!0,{},d);this.canvas=document.createElement("canvas");this.baseDiv=document.createElement("div");this.percentDiv=document.createElement("div");var d=this.canvas,c=this.baseDiv,a=this.percentDiv;d.width=this.style.throbber.width;d.height=this.style.throbber.height;d.style.display="block";d.style.position="absolute";c.style.width=this.style.throbber.width+"px";c.style.height=this.style.throbber.height+
"px";c.appendChild(d);a.style.width=this.style.throbber.width+"px";a.style.height=this.style.throbber.height+"px";a.style.lineHeight=this.style.throbber.height+"px";a.className="throbber-percent";c.appendChild(a);this.positions=l(d.width,this.style.throbber.lines)};f.prototype={show:function(b){b&&(this.root=b,this.highlightPos=1,this.hide(),this.root.appendChild(this.baseDiv),this._run())},hide:function(){b(this.baseDiv).remove();this._runId&&(clearTimeout(this._runId),this._runId=null)},_run:function(){var b=
this.canvas,c=b.getContext("2d"),a=this.highlightPos,e=this.positions,g=this.style.throbberLine.color,f=this.style.throbberLine.width,k=this.style.throbber.lines,h=this.style.throbber.roundTime;b.width=b.width;for(var b=0,l=e.length;b<l;b++){c.beginPath();c.strokeStyle=g;c.lineWidth=f;var n=b+1;c.globalAlpha=n==a?1:n==a+1||n==a-1?0.75:0.4;var m=e[b],n=m.from,m=m.to;c.moveTo(n.x,n.y);c.lineTo(m.x,m.y);c.stroke()}a==k?a=0:a++;this.highlightPos=a;var o=this;this._runId=setTimeout(function(){o._run.call(o)},
Math.floor(h/k))},setPercent:function(b){this.percentDiv.innerHTML=b}};m.prototype={show:function(){var d=this._style,c=null;this._isGlobalBlockTarget()?(b.blockUI(d),c=b("body").children(".blockUI."+d.blockMsgClass+".blockPage")):(c=b(this.target),c.block(d),c=c.children(".blockUI."+d.blockMsgClass+".blockElement"));this.throbber.show(c.children(".indicator-throbber")[0]);this._setPositionAndResizeWidth();return this},_setPositionAndResizeWidth:function(){var d=this._style,c=null,a=null,e=0;this._isGlobalBlockTarget()?
(c=b("body"),a=c.children(".blockUI."+d.blockMsgClass+".blockPage"),a.css("top",(b(window).height()-a.outerHeight())/2+"px")):(c=b(this.target),a=c.children(".blockUI."+d.blockMsgClass+".blockElement"),a.css("top",(c.height()-a.outerHeight())/2+"px"));d=a.innerWidth()-a.width();a.children().each(function(){e=e+b(this).outerWidth(true)});a.width(e+d);a.css("left",(c.width()-a.outerWidth())/2+"px")},_isGlobalBlockTarget:function(){return this.target===document||this.target===window||this.target===document.body},
hide:function(){this._isGlobalBlockTarget()?b.unblockUI():b(this.target).unblock();return this},percent:function(b){"number"===typeof b&&0<=b&&100>=b&&this.throbber.setPercent(b);return this},message:function(c){if("string"===typeof c){var e=this._style,a=null,a=this._isGlobalBlockTarget()?b("body").children(".blockUI."+e.blockMsgClass+".blockPage"):b(this.target).children(".blockUI."+e.blockMsgClass+".blockElement");a.children(".indicator-message").css("display","inline-block").text(c);this._setPositionAndResizeWidth()}return this}};
e.u.obj.expose("h5.ui",{indicator:function(b,c){return new m(b,c)},isInView:function(c,g){var a,f,k,h,l=b(c);if(void 0===g)f=e.env.ua.isiOS?window.innerHeight:b(window).height(),h=e.env.ua.isiOS?window.innerWidth:b(window).width(),a=b(window).scrollTop(),k=b(window).scrollLeft();else{h=b(g);if(0===h.find(l).length)return;a=h.offset().top+parseInt(h.css("border-top-width"));k=h.offset().left+parseInt(h.css("border-left-width"));f=h.innerHeight();h=h.innerWidth()}f=a+f;h=k+h;var n=l.offset().top,m=
l.offset().left,o=n+l.outerHeight(),l=m+l.outerWidth();return(a<=n&&n<f||a<o&&o<=f)&&(k<=m&&m<h||k<l&&l<=h)},scrollToTop:function(){function c(){1===window.scrollY&&(e=0);0<e&&(window.scrollTo(0,1),e--,setTimeout(c,a))}var e=3,a=500;window.scrollTo(0,1);1!==b(window).scrollTop&&setTimeout(c,a)}})})();(function(){function h(e){if(e=b.mobile.activePage){var e=e.attr("id"),g=c[e];if(l[e]&&(!g||0===g.length))n.addCSS(e),n.bindController(e)}}e.log.createLogger("h5.ui.jqm.manager");var n=null,l={},c={},
m={},r={},s=!1;e.u.obj.ns("h5.ui.jqm");e.ui.jqm.dataPrefix="h5";var x={__name:"JQMController",__ready:function(){var c=this;b(':jqmData(role="page"), :jqmData(role="dialog")').each(function(){c.loadScript(this.id)})},':jqmData(role="page"), :jqmData(role="dialog") pageinit':function(b){b=b.event.target.id;this.loadScript(b);this.addCSS(b);this.bindController(b)},"{document} pageremove":function(b){var b=b.event.target.id,e=c[b];if(e){for(var h=0,f=e.length;h<f;h++)e[h].dispose();c[b]=[]}},"{document} pagebeforeshow":function(b){b=
b.event.target.id;this.addCSS(b);for(var e in c)for(var h=c[e],f=b===e,d=0,l=h.length;d<l;d++){var a=h[d];f?a.enableListeners():a.disableListeners()}},"{document} pagehide":function(b){this.removeCSS(b.event.target.id)},"{rootElement} h5controllerbound":function(b){if(this!==b.evArg){var e=b.event.target.id;c[e]||(c[e]=[]);c[e].push(b.evArg)}},loadScript:function(c){var c=b("#"+c),g=b.trim(c.data(this.getDataAttribute("script")));if(0!==g.length)return g=b.map(g.split(","),function(c){return b.trim(c)}),
c=!0==c.data(this.getDataAttribute("async")),e.u.loadScript(g,{async:c})},getDataAttribute:function(b){var c=e.ui.jqm.dataPrefix;null==c&&(c="h5");return 0!==c.length?c+"-"+b:b},bindController:function(b){var g=c[b];l[b]&&!(g&&0<g.length)&&e.core.controller("#"+b,l[b],m[b])},addCSS:function(c){var e=r[c];if(e)for(var h=document.getElementsByTagName("head")[0],f=h.getElementsByTagName("link"),d=f.length,e=z(e),l=0,e=e.length;l<e;l++){for(var a=b.mobile.path.parseUrl(r[c][l]).filename,i=!1,n=0;n<d;n++)if(b.mobile.path.parseUrl(f[n].href).filename===
a){i=!0;break}i||(a=document.createElement("link"),a.type="text/css",a.rel="stylesheet",a.href=r[c][l],h.appendChild(a))}},removeCSS:function(c){if(c=r[c]){var e=b.mobile.activePage.attr("id"),e=r[e],h=z(c),f=z(e);b("link").filter(function(){var c=b(this).attr("href");return-1!==b.inArray(c,h)&&-1===b.inArray(c,f)}).remove()}}};e.u.obj.expose("h5.ui.jqm.manager",{init:function(){s||(s=!0,b(function(){n=e.core.controller("body",x);h()}))},define:function(c,g,s,f){l[c]=s;m[c]=f;r[c]=z(g);b.mobile.activePage&&
b.mobile.activePage.attr("id")===c&&(!n?e.ui.jqm.manager.init():h())}})})();(function(){function o(){c||(c=navigator.geolocation);return c}function n(b,c){this.oblateness=b;this.semiMajorAxis=c}function l(){}N({2E3:"正しい緯度または経度を指定して下さい。",2001:"正しい計算モード定数を指定して下さい",2002:"位置情報の取得に失敗しました。"});var c=null,m=e.env.ua;n.prototype.getOblateness=function(){return this.oblateness};n.prototype.getSemiMajorAxis=function(){return this.semiMajorAxis};var r=new n(298.257222,6378137),s=new n(299.152813,6377397.155),
x=Math.PI/180;b.extend(l.prototype,{isSupported:m.isIE&&9<=m.browserVersion?!0:!!o(),getCurrentPosition:function(b){var c=e.async.deferred();o().getCurrentPosition(function(b){c.resolve(b)},function(b){c.reject(K(2002,null,b))},b);return c.promise()},watchPosition:function(b){function c(){}var h=e.async.deferred(),f=o().watchPosition(function(b){h.notify(b)},function(b){h.reject(K(2002,null,b))},b);c.prototype.unwatch=function(){o().clearWatch(f);h.resolve()};return h.promise(new c)},getDistance:function(b,
c,e,f,d){if(!isFinite(b)||!isFinite(c)||!isFinite(e)||!isFinite(f))throw new h(2E3);var l=d?d:r;if(!(l instanceof n))throw new h(2001);var d=l.getSemiMajorAxis(),a=l.getOblateness(),b=b*x,c=c*x,e=e*x,l=f*x,f=(b+e)/2,a=Math.sqrt(2*a-1)/a,a=Math.pow(a,2),i=Math.sqrt(1-a*Math.pow(Math.sin(f),2)),a=d*(1-a)/Math.pow(i,3),d=d/i,c=c-l;return Math.sqrt(Math.pow(a*(b-e),2)+Math.pow(d*Math.cos(f)*c,2))},GS_GRS80:r,GS_BESSEL:s});e.u.obj.expose("h5.api",{geo:new l})})();(function(){function o(a){switch(a.code){case a.CONSTRAINT_ERR:return"一意制約に反しています。";
case a.DATABASE_ERR:return"データベースエラー";case a.QUOTA_ERR:return"空き容量が不足しています。";case a.SYNTAX_ERR:return"構文に誤りがあります。";case a.TIMEOUT_ERR:return"ロック要求がタイムアウトしました。";case a.TOO_LARGE_ERR:return"取得結果の行が多すぎます。";case a.UNKNOWN_ERR:return"トランザクション内で例外がスローされました。";case a.VERSION_ERR:return"データベースのバージョンが一致しません。"}}function n(a,b){for(var c=a._tasks,d=c.length-1;0<=d;d--){var e=c[d],g=o(b);e.deferred.reject(K(L,[g,b.message],b))}}function l(a){for(var a=a._tasks,b=a.length-1;0<=b;b--){var c=a[b];c.deferred.resolve(c.result)}}
function c(a){if(a)throw new h(B);}function m(a,b){if("string"!==typeof b)throw new h(q,a);}function r(a,b){if(void 0!=b&&!(b instanceof k))throw new h(C,a);}function s(a,c,d){if(b.isPlainObject(a))for(var e in a){var g=b.trim(e).replace(/ +/g," ").split(" "),f=[];if(""===g[0])throw new h(I);if(1===g.length)f.push(g[0]),f.push("="),f.push("?");else if(/^(<=|<|>=|>|=|!=|like)$/i.test(g[1]))3===g.length&&/^like$/i.test(g[1])?(f.push(g[0]),f.push(g[1]),f.push("?"),f.push("ESCAPE"),f.push('"'+g[2]+'"')):
(f.push(g[0]),f.push(g[1]),f.push("?"));else throw new h(D);c.push(f.join(" "));d.push(a[e])}}function x(){}function k(a,b){this._db=a;this._tx=b;this._tasks=[]}function g(a,c,d,g,f){c=e.u.str.format(H,d,c);b.isPlainObject(g)?(d=[],s(g,d,a),c+=" WHERE "+d.join(" AND ")):"string"===typeof g&&(c+=" WHERE "+g);b.isArray(f)&&(c+=" ORDER BY "+f.join(", "));return c}function F(a,c,d){this._txw=a;this._tableName=c;this._columns=b.isArray(d)?d.join(", "):"*";this._statement=this._orderBy=this._where=null;
this._params=[];this._df=G();this._executed=!1}function f(a,b,c){this._txw=a;this._tableName=b;this._values=c?z(c):[];this._statement=[];this._params=[];this._df=G();this._executed=!1}function d(a,b,c){this._txw=a;this._tableName=b;this._value=c;this._statement=this._where=null;this._params=[];this._df=G();this._executed=!1}function p(a,b){this._txw=a;this._tableName=b;this._statement=this._where=null;this._params=[];this._df=G();this._executed=!1}function a(a,b,c){this._txw=a;this._statement=b;this._params=
c||[];this._df=G();this._executed=!1}function i(a){this._txw=a;this._queue=[];this._df=G();this._executed=!1}function v(a){this._db=a}function t(){}var H="SELECT {0} FROM {1}",B=3E3,q=3001,C=3002,D=3003,L=3010,I=3011,E={};E[B]="同一オブジェクトによるSQLの再実行はできません。";E[q]="{0}: テーブル名を指定して下さい。";E[C]="{0}: トランザクションが不正です。";E[D]="オペレータが不正です。 <= < >= > = != like のいずれかを使用して下さい。";E[3004]="{0}: {1}に指定したオブジェクトの型が不正です。";E[3005]="{0}: カラム名を指定して下さい。";E[3006]="{0}: 値を指定して下さい。";E[3007]="{0}: ステートメントが不正です。";E[3008]="{0}: パラメータは配列で指定して下さい。";
E[3009]="指定されたオブジェクトはトランザクションに追加できません。Insert/Update/Del/Select/Sqlクラスのインスタンスを指定して下さい。";E[L]="トランザクション処理中にエラーが発生しました。{0} {1}";E[I]="where句に指定されたカラム名が空白または空文字です。";N(E);var G=e.async.deferred;b.extend(k.prototype,{_runTransaction:function(){return null!=this._tx},_execute:function(a,b,c){this._runTransaction()?this._tx.executeSql(a,b,c):this._db.transaction(a,b,c)},_addTask:function(a){this._tasks.push({deferred:a,result:null})},_setResult:function(a){this._tasks[this._tasks.length-1].result=a}});F.prototype=
new x;b.extend(F.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new h(3004,["Select","where"]);this._where=a;return this},orderBy:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new h(3004,["Select","orderBy"]);this._orderBy=z(a);return this},execute:function(){var a=this,b=G(),d=this._txw,e=this._executed,f=null;try{d._addTask(b),c(e),a._statement=g(a._params,a._tableName,a._columns,a._where,a._orderBy),d._runTransaction()?d._execute(this._statement,
this._params,function(a,c){f=c.rows;d._setResult(f);b.notify(f,d)}):d._execute(function(c){d._tx=c;c.executeSql(a._statement,a._params,function(a,c){f=c.rows;d._setResult(f);b.notify(f,d)})},function(a){n(d,a)},function(){l(d)})}catch(h){b.reject(h)}this._executed=!0;return b.promise()}});f.prototype=new x;b.extend(f.prototype,{execute:function(){function a(){d._statement.length===o?(k=m,h._setResult(k),f.notify(k,h)):h._execute(d._statement[o],d._params[o],function(b,c){o++;m.push(c.insertId);a()})}
var d=this,g=function(){var a=d._values;if(0===a.length)d._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",d._tableName)),d._params.push([]);else for(var c=0,f=a.length;c<f;c++){var g=a[c];if(null==g)d._statement.push(e.u.str.format("INSERT INTO {0} DEFAULT VALUES",d._tableName)),d._params.push([]);else if(b.isPlainObject(g)){var j=[],h=[],i=[],k;for(k in g)j.push("?"),h.push(k),i.push(g[k]);d._statement.push(e.u.str.format("INSERT INTO {0} ({1}) VALUES ({2})",d._tableName,h.join(", "),
j.join(", ")));d._params.push(i)}}},f=G(),h=this._txw,i=this._executed,k=null,m=[],o=0;try{h._addTask(f),c(i),g(),h._runTransaction()?a():h._execute(function(b){h._tx=b;a()},function(a){n(h,a)},function(){l(h)})}catch(p){f.reject(p)}this._executed=!0;return f.promise()}});d.prototype=new x;b.extend(d.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new h(3004,["Update","where"]);this._where=a;return this},execute:function(){var a=this,d=function(){var c=a._where,d=a._value,
f=[],g;for(g in d)f.push(g+" = ?"),a._params.push(d[g]);a._statement=e.u.str.format("UPDATE {0} SET {1}",a._tableName,f.join(", "));b.isPlainObject(c)?(d=[],s(c,d,a._params),a._statement+=" WHERE "+d.join(" AND ")):"string"===typeof c&&(a._statement+=" WHERE "+c)},g=G(),f=this._txw,h=this._executed,i=null;try{f._addTask(g),c(h),d(),f._runTransaction()?f._execute(this._statement,this._params,function(a,b){i=b.rowsAffected;f._setResult(i);g.notify(i,f)}):f._execute(function(b){f._tx=b;b.executeSql(a._statement,
a._params,function(a,b){i=b.rowsAffected;f._setResult(i);g.notify(i,f)})},function(a){n(f,a)},function(){l(f)})}catch(k){g.reject(k)}this._executed=!0;return g.promise()}});p.prototype=new x;b.extend(p.prototype,{where:function(a){if(!b.isPlainObject(a)&&"string"!==typeof a)throw new h(3004,["Del","where"]);this._where=a;return this},execute:function(){var a=this,d=function(){var c=a._where;a._statement=e.u.str.format("DELETE FROM {0}",a._tableName);if(b.isPlainObject(c)){var d=[];s(c,d,a._params);
a._statement+=" WHERE "+d.join(" AND ")}else"string"===typeof c&&(a._statement+=" WHERE "+c)},f=G(),g=this._txw,h=this._executed,i=null;try{g._addTask(f),c(h),d(),g._runTransaction()?g._execute(this._statement,this._params,function(a,b){i=b.rowsAffected;g._setResult(i);f.notify(i,g)}):g._execute(function(b){g._tx=b;b.executeSql(a._statement,a._params,function(a,b){i=b.rowsAffected;g._setResult(i);f.notify(i,g)})},function(a){n(g,a)},function(){l(g)})}catch(k){f.reject(k)}this._executed=!0;return f.promise()}});
a.prototype=new x;b.extend(a.prototype,{execute:function(){var a=G(),b=this._txw,d=this._executed,e=this._statement,g=this._params,f=null;try{b._addTask(a),c(d),b._runTransaction()?b._execute(e,g,function(c,d){f=d;b._setResult(f);a.notify(f,b)}):b._execute(function(c){b._tx=c;c.executeSql(e,g,function(c,d){f=d;b._setResult(f);a.notify(f,b)})},function(a){n(b,a)},function(){l(b)})}catch(h){a.reject(h)}this._executed=!0;return a.promise()}});i.prototype=new x;b.extend(i.prototype,{add:function(a){if(!(a instanceof
x))throw new h(3009);this._queue.push(a);return this},execute:function(){function a(b){function c(a){this._txw=new k(null,a)}for(var d=[],e=0,g=f.length;e<g;e++)c.prototype=f[e],d.push(new c(b));return d}function b(){if(i.length===h){for(var a=[],c=0,f=i.length;c<f;c++)a.push(i[c]._txw._tasks[0].result);e._setResult(a);d.notify(a,e)}else i[h].execute().progress(function(){h++;b()})}var d=this._df,e=this._txw,f=this._queue,g=this._executed,h=0,i=null;try{e._addTask(d),c(g),e._runTransaction()?(i=a(e._tx),
b()):e._execute(function(c){i=a(c);e._tx=c;b()},function(a){n(e,a)},function(){l(e)})}catch(m){d.reject(m)}this._df=G();this._executed=!0;return d.promise()},promise:function(){return this._df.promise()}});b.extend(v.prototype,{select:function(a,c,d){m("select",a);r("select",d);if(!b.isArray(c)&&"*"!==c)throw new h(3005,"select");return new F(d?d:new k(this._db,null),a,c)},insert:function(a,c,d){m("insert",a);r("insert",d);if(null!=c&&!b.isArray(c)&&!b.isPlainObject(c))throw new h(3006,"insert");
return new f(d?d:new k(this._db,null),a,c)},update:function(a,c,e){m("update",a);r("update",e);if(!b.isPlainObject(c))throw new h(3006,"update");return new d(e?e:new k(this._db,null),a,c)},del:function(a,b){m("del",a);r("del",b);return new p(b?b:new k(this._db,null),a)},sql:function(c,d,e){r("sql",e);if("string"!==typeof c)throw new h(3007,"sql");if(null!=d&&!b.isArray(d))throw new h(3008,"sql");return new a(e?e:new k(this._db,null),c,d)},transaction:function(a){r("sql",a);return new i(a?a:new k(this._db,
null))}});b.extend(t.prototype,{isSupported:!!window.openDatabase,open:function(a,b,c,d){if(this.isSupported)return a=openDatabase(a,b,c,d),new v(a)}});e.u.obj.expose("h5.api",{sqldb:new t})})();(function(){function h(b){this._storage=b}e.log.createLogger("h5.api.storage");b.extend(h.prototype,{getLength:function(){return this._storage.length},key:function(b){return this._storage.key(b)},getItem:function(b){b=this._storage.getItem(b);return null===b?null:e.u.obj.deserialize(b)},setItem:function(b,
h){this._storage.setItem(b,e.u.obj.serialize(h))},removeItem:function(b){this._storage.removeItem(b)},clear:function(){this._storage.clear()},each:function(b){for(var e=this._storage,c=0,h=e.length;c<h;c++){var o=e.key(c);b(c,o,this.getItem(o))}}});e.u.obj.expose("h5.api.storage",{isSupported:!!window.localStorage,local:new h(window.localStorage),session:new h(window.sessionStorage)})})()})(jQuery);